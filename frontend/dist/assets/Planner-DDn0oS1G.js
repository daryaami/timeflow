import{e as d,g as w,f as C,h as f,r as B,o as r,i as $,w as S,c as o,b as e,t as m,j as k,n as b,k as x,l as D,m as T,F as g,p as y,u as E,q as V,s as N,v as O,x as P,_ as z,y as H,z as I,a as W,A as R,B as F,C as U}from"./index-Dhk7C9Sd.js";const q={key:0,class:"event-card__short-wrapper"},X={class:"event-card__name"},j={class:"event-card__time"},A={class:"event-card__name-wrapper"},G={key:1,class:"event-card__time"},Y={__name:"EventCard",props:["event","gridHeight"],setup(l){const a=l,t=d(w(a.event.end.dateTime)-w(a.event.start.dateTime)),n=d(C(a.event.start.dateTime)),u=f(()=>w(a.event.start.dateTime)*100/24),s=f(()=>Math.max(t.value,.25)*100/24),_=f(()=>`${n.value} - ${C(a.event.end.dateTime)}`),v=f(()=>new Date(a.event.end.dateTime)<new Date),i=f(()=>a.gridHeight?[10,a.gridHeight/96]:[0,0]);return(c,p)=>{const h=B("vue-draggable-resizable");return l.gridHeight?(r(),$(h,{key:0,class:b(["event-card",{"no-padding":t.value<=.25,"no-right-padding":t.value<=.5,past:v.value}]),axis:"y",grid:i.value,handles:["tm","bm"],active:!0,style:x({top:`${u.value}%`,height:`calc(${s.value}% - 2px)`,backgroundColor:`${l.event.background_color}`,color:`${l.event.foreground_color}`})},{default:S(()=>[t.value<=.5?(r(),o("div",q,[e("span",X,m(l.event.summary)+", ",1),e("span",j,m(n.value),1)])):k("",!0),e("div",A,[t.value>.5?(r(),o("span",{key:0,class:b(["event-card__name",{"one-string":t.value<=1}])},m(l.event.summary),3)):k("",!0)]),t.value>.5?(r(),o("span",G,m(_.value),1)):k("",!0)]),_:1},8,["grid","style","class"])):k("",!0)}}},J=[{time:"01:00",percent:100/24},{time:"02:00",percent:200/24},{time:"03:00",percent:300/24},{time:"04:00",percent:400/24},{time:"05:00",percent:500/24},{time:"06:00",percent:600/24},{time:"07:00",percent:700/24},{time:"08:00",percent:800/24},{time:"09:00",percent:900/24},{time:"10:00",percent:1e3/24},{time:"11:00",percent:1100/24},{time:"12:00",percent:1200/24},{time:"13:00",percent:1300/24},{time:"14:00",percent:1400/24},{time:"15:00",percent:1500/24},{time:"16:00",percent:1600/24},{time:"17:00",percent:1700/24},{time:"18:00",percent:1800/24},{time:"19:00",percent:1900/24},{time:"20:00",percent:2e3/24},{time:"21:00",percent:2100/24},{time:"22:00",percent:2200/24},{time:"23:00",percent:2300/24}],K={class:"planner__line-time"},Q={class:"planner__line-time"},Z={__name:"PlannerGrid",props:["currentWeekEvents"],setup(l){const a=d(null),t=d(),n=d(null),u=d(null),s=d({caption:"",styleTop:""}),_=()=>{const c=document.querySelector(".planner-date.current");if(!c)return;const p=(c.getBoundingClientRect().left-n.value.getBoundingClientRect().left)/n.value.offsetWidth*100,h=c.offsetWidth*.9/n.value.offsetWidth*100;u.value.style.left=`${p}%`,u.value.style.width=`${h}%`},v=()=>{const c=new Date;s.value.caption=C(c),s.value.styleTop=`${w(c)*100/24}%`},i=async()=>{v(),await T(),_(),n.value.scrollIntoView({block:"center"});const p=(60-new Date().getSeconds())*1e3;setTimeout(()=>{v(),setInterval(v,6e4)},p)};return D(async()=>{await T(),i(),t.value=a.value.offsetHeight}),(c,p)=>(r(),o("div",{class:"planner__grid",ref_key:"grid",ref:a},[(r(!0),o(g,null,y(l.currentWeekEvents,h=>(r(),o("div",{class:"planner__day-column",key:h.date},[(r(!0),o(g,null,y(h.events,(L,M)=>(r(),$(Y,{key:M,event:L,gridHeight:t.value},null,8,["event","gridHeight"]))),128))]))),128)),(r(!0),o(g,null,y(E(J),(h,L)=>(r(),o("div",{class:"planner__line",key:L,style:x({top:`${h.percent}%`})},[e("div",K,m(h.time),1)],4))),128)),e("div",{class:"planner__line planner__line--now",style:x({top:`${s.value.styleTop}`}),ref_key:"timeLineEl",ref:n},[e("div",Q,m(s.value.caption),1),e("div",{class:"planner__line-today-line",ref_key:"todayLine",ref:u},null,512)],4)],512))}},ee={class:"planner-header"},te={class:"planner-header__date"},ne={class:"planner-header__buttons"},ae={__name:"PlannerHeader",props:V(["isSidebarOpened","currentMonth"],{modelValue:{},modelModifiers:{}}),emits:V(["prevWeek","nextWeek"],["update:modelValue"]),setup(l,{emit:a}){const t=a,n=N(l,"modelValue");return(u,s)=>(r(),o("header",ee,[e("span",te,m(l.currentMonth),1),e("div",ne,[e("button",{class:"planner-header__date-button planner-header__date-button--prev icon-button",onClick:s[0]||(s[0]=_=>t("prevWeek"))}),e("button",{class:"planner-header__date-button planner-header__date-button--next icon-button",onClick:s[1]||(s[1]=_=>t("nextWeek"))})]),e("label",{class:b(["sidebar-hide icon-button",{rotated:!n.value}])},[O(e("input",{type:"checkbox",class:"visually-hidden","onUpdate:modelValue":s[2]||(s[2]=_=>n.value=_)},null,512),[[P,n.value]])],2)]))}},se={},re={class:"loading-container"},le=e("div",{class:"loading-progress"},null,-1),oe=[le];function ie(l,a){return r(),o("div",re,oe)}const ce=z(se,[["render",ie]]),ue={class:"planner-date__weekday"},de={class:"planner-date__day"},_e={__name:"PlannerDate",props:["date"],setup(l){const a=l,[t,n,u]=a.date.split("-").map(Number),s=new Date(t,n-1,u),_=f(()=>s.toLocaleDateString("en-EN",{weekday:"short"})),v=f(()=>new Date().getDate()===s.getDate());return(i,c)=>(r(),o("div",{class:b(["planner-date",{current:v.value}])},[e("span",ue,m(_.value),1),e("div",de,[e("span",null,m(E(u)),1)])],2))}},ve={class:"task"},pe=["for"],me=["id"],he={__name:"TaskItem",props:["task"],setup(l){return(a,t)=>(r(),o("div",ve,[e("span",{class:"task__color",style:x({backgroundColor:l.task.color})},null,4),e("label",{class:"task__checkbox-label",for:a.title},[e("input",{class:"visually-hidden",id:a.title,type:"checkbox"},null,8,me)],8,pe),e("span",null,m(l.task.name),1)]))}},fe={class:"right-sidebar__tabs"},ke=e("span",null,"Habits",-1),ge=[ke],ye=e("span",null,"Tasks",-1),$e=[ye],be={class:"underline"},we={key:0,class:"tasks"},xe={__name:"RightSidebar",props:["isOpened"],setup(l){const a=d(),t=d(),n=d(null),u=d(null),s=d(null),_=d(H.value.tasks);return D(()=>{s.value=u.value}),I(s,()=>{a.value.style.transform=`translateX(${s.value.offsetLeft}px)`,t.value.style.transform=`translateX(${s.value.offsetLeft}px)`}),(v,i)=>(r(),o("div",{class:b(["right-sidebar",{hidden:!l.isOpened}])},[e("div",fe,[e("button",{ref_key:"habitsButton",ref:n,class:"right-sidebar__tab",onClick:i[0]||(i[0]=c=>s.value=n.value)},ge,512),e("button",{ref_key:"tasksButton",ref:u,class:"right-sidebar__tab",onClick:i[1]||(i[1]=c=>s.value=u.value)},$e,512),e("div",be,[e("div",{ref_key:"underlineRight",ref:a,class:"underline__closer underline__closer--right"},null,512),e("div",{ref_key:"underlineLeft",ref:t,class:"underline__closer underline__closer--left"},null,512)])]),s.value===u.value?(r(),o("div",we,[(r(!0),o(g,null,y(_.value,c=>(r(),$(he,{key:c.id,task:c},null,8,["task"]))),128))])):k("",!0)],2))}},Te={class:"planner-wrapper"},Le={class:"planner"},We={key:0,class:"planner__loader-wrapper"},Ce={key:1,class:"planner__grid-wrapper"},De={class:"planner__days-header"},Ve={__name:"Planner",setup(l){const a=d(!0),t=d(null),n=d(!0),u=async()=>{try{t.value=await R()}catch(i){console.error("ошибка",i)}finally{n.value=!1}},s=async()=>{if(n.value)return;n.value=!0;const i=await F(t.value.mon.date);t.value=i,n.value=!1,await T(),timeLineEl.value.scrollIntoView({block:"center"})},_=async()=>{if(n.value)return;n.value=!0;const i=await U(t.value.mon.date);t.value=i,n.value=!1,await T(),timeLineEl.value.scrollIntoView({block:"center"})},v=f(()=>{if(t.value){const i=new Date(t.value.mon.date);return`${i.toLocaleString("default",{month:"long"})} ${i.getFullYear()}`}else return""});return D(()=>{u()}),(i,c)=>(r(),o("div",Te,[e("div",Le,[W(ae,{modelValue:a.value,"onUpdate:modelValue":c[0]||(c[0]=p=>a.value=p),currentMonth:v.value,onPrevWeek:_,onNextWeek:s},null,8,["modelValue","currentMonth"]),n.value?(r(),o("div",We,[W(ce)])):k("",!0),n.value?k("",!0):(r(),o("div",Ce,[e("div",De,[(r(!0),o(g,null,y(t.value,p=>(r(),$(_e,{key:p.date,date:p.date},null,8,["date"]))),128))]),W(Z,{currentWeekEvents:t.value},null,8,["currentWeekEvents"])]))]),E(H)?(r(),$(xe,{key:0,isOpened:a.value},null,8,["isOpened"])):k("",!0)]))}};export{Ve as default};
