import{m as V,e as H,f as k,o as n,c as l,b as e,t as v,g as P,v as z,n as b,_ as F,h as d,i as w,j as L,k as f,l as T,u as S,p as W,q as B,s as I,F as y,x as $,y as x,a as C,z as R,A as E,B as U}from"./index-CswN4lUC.js";const X={class:"planner-header"},j={class:"planner-header__date"},q={class:"planner-header__buttons"},A={__name:"PlannerHeader",props:V("isSidebarOpened",{modelValue:{},modelModifiers:{}}),emits:V(["prevWeek","nextWeek"],["update:modelValue"]),setup(r,{emit:a}){const t=a,c=H(r,"modelValue"),o=k(()=>{const s=new Date;return`${s.toLocaleString("default",{month:"long"})} ${s.getFullYear()}`});return(s,u)=>(n(),l("header",X,[e("span",j,v(o.value),1),e("div",q,[e("button",{class:"planner-header__date-button planner-header__date-button--prev icon-button",onClick:u[0]||(u[0]=i=>t("prevWeek"))}),e("button",{class:"planner-header__date-button planner-header__date-button--next icon-button",onClick:u[1]||(u[1]=i=>t("nextWeek"))})]),e("label",{class:b(["sidebar-hide icon-button",{rotated:!c.value}])},[P(e("input",{type:"checkbox",class:"visually-hidden","onUpdate:modelValue":u[2]||(u[2]=i=>c.value=i)},null,512),[[z,c.value]])],2)]))}},Y={},G={class:"loading-container"},J=e("div",{class:"loading-progress"},null,-1),K=[J];function Q(r,a){return n(),l("div",G,K)}const Z=F(Y,[["render",Q]]),ee={key:0,class:"event-card__short-wrapper"},te={class:"event-card__name"},ne={class:"event-card__time"},ae={class:"event-card__name-wrapper"},se={key:1,class:"event-card__time"},le={__name:"EventCard",props:["event"],setup(r){const a=r,t=d(w(a.event.end.dateTime)-w(a.event.start.dateTime)),c=d(L(a.event.start.dateTime)),o=k(()=>w(a.event.start.dateTime)*100/24),s=k(()=>t.value*100/24),u=k(()=>`${c.value} - ${L(a.event.end.dateTime)}`),i=k(()=>new Date(a.event.end.dateTime)<new Date);return(m,h)=>(n(),l("div",{class:b(["event-card",{"no-padding":t.value<=.25,"no-right-padding":t.value<=.5,past:i.value}]),style:T({top:`${o.value}%`,height:`calc(${s.value}% - 2px)`,backgroundColor:`${r.event.background_color}`,color:`${r.event.foreground_color}`})},[t.value<=.5?(n(),l("div",ee,[e("span",te,v(r.event.summary)+", ",1),e("span",ne,v(c.value),1)])):f("",!0),e("div",ae,[t.value>.5?(n(),l("span",{key:0,class:b(["event-card__name",{"one-string":t.value<=1}])},v(r.event.summary),3)):f("",!0)]),t.value>.5?(n(),l("span",se,v(u.value),1)):f("",!0)],6))}},re={class:"planner-date__weekday"},oe={class:"planner-date__day"},ie={__name:"PlannerDate",props:["date"],setup(r){const a=r,[t,c,o]=a.date.split("-").map(Number),s=new Date(t,c-1,o),u=k(()=>s.toLocaleDateString("en-EN",{weekday:"short"})),i=k(()=>new Date().getDate()===s.getDate());return(m,h)=>(n(),l("div",{class:b(["planner-date",{current:i.value}])},[e("span",re,v(u.value),1),e("div",oe,[e("span",null,v(S(o)),1)])],2))}},ce={class:"task"},ue=["for"],de=["id"],_e={__name:"TaskItem",props:["task"],setup(r){return(a,t)=>(n(),l("div",ce,[e("span",{class:"task__color",style:T({backgroundColor:r.task.color})},null,4),e("label",{class:"task__checkbox-label",for:a.title},[e("input",{class:"visually-hidden",id:a.title,type:"checkbox"},null,8,de)],8,ue),e("span",null,v(r.task.name),1)]))}},pe={class:"right-sidebar__tabs"},ve=e("span",null,"Habits",-1),me=[ve],he=e("span",null,"Tasks",-1),ke=[he],fe={class:"underline"},ye={key:0,class:"tasks"},$e={__name:"RightSidebar",props:["isOpened"],setup(r){const a=d(),t=d(),c=d(null),o=d(null),s=d(null),u=d(W.value.tasks);return B(()=>{s.value=o.value}),I(s,()=>{a.value.style.transform=`translateX(${s.value.offsetLeft}px)`,t.value.style.transform=`translateX(${s.value.offsetLeft}px)`}),(i,m)=>(n(),l("div",{class:b(["right-sidebar",{hidden:!r.isOpened}])},[e("div",pe,[e("button",{ref_key:"habitsButton",ref:c,class:"right-sidebar__tab",onClick:m[0]||(m[0]=h=>s.value=c.value)},me,512),e("button",{ref_key:"tasksButton",ref:o,class:"right-sidebar__tab",onClick:m[1]||(m[1]=h=>s.value=o.value)},ke,512),e("div",fe,[e("div",{ref_key:"underlineRight",ref:a,class:"underline__closer underline__closer--right"},null,512),e("div",{ref_key:"underlineLeft",ref:t,class:"underline__closer underline__closer--left"},null,512)])]),s.value===o.value?(n(),l("div",ye,[(n(!0),l(y,null,$(u.value,h=>(n(),x(_e,{key:h.id,task:h},null,8,["task"]))),128))])):f("",!0)],2))}},be={class:"planner-wrapper"},ge={class:"planner"},we={key:0,class:"planner__loader-wrapper"},xe={key:1,class:"planner__grid-wrapper"},Te={class:"planner__days-header"},De={class:"planner__grid"},Le={class:"planner__line-time"},Ve={class:"planner__line-time"},Ee={__name:"Planner",setup(r){const a=d(!0),t=d(null),c=d(null),o=d({caption:"",styleTop:""}),s=()=>{const _=new Date;o.value.caption=L(_),o.value.styleTop=`${w(_)*100/24}%`},u=async()=>{s(),await U(),c.value.scrollIntoView({block:"center"});const g=(60-new Date().getSeconds())*1e3;setTimeout(()=>{s(),setInterval(s,6e4)},g)},i=d(!0),m=async()=>{try{t.value=await R()}catch(_){console.error("ошибка",_)}finally{i.value=!1,u()}},h=async()=>{i.value=!0;const _=await E(t.value.mon.date);t.value=_,i.value=!1},N=async()=>{i.value=!0;const _=await E(t.value.mon.date);t.value=_,i.value=!1};B(()=>{m()});const O=[{time:"01:00",percent:100/24},{time:"02:00",percent:200/24},{time:"03:00",percent:300/24},{time:"04:00",percent:400/24},{time:"05:00",percent:500/24},{time:"06:00",percent:600/24},{time:"07:00",percent:700/24},{time:"08:00",percent:800/24},{time:"09:00",percent:900/24},{time:"10:00",percent:1e3/24},{time:"11:00",percent:1100/24},{time:"12:00",percent:1200/24},{time:"13:00",percent:1300/24},{time:"14:00",percent:1400/24},{time:"15:00",percent:1500/24},{time:"16:00",percent:1600/24},{time:"17:00",percent:1700/24},{time:"18:00",percent:1800/24},{time:"19:00",percent:1900/24},{time:"20:00",percent:2e3/24},{time:"21:00",percent:2100/24},{time:"22:00",percent:2200/24},{time:"23:00",percent:2300/24}];return(_,g)=>(n(),l("div",be,[e("div",ge,[C(A,{modelValue:a.value,"onUpdate:modelValue":g[0]||(g[0]=p=>a.value=p),onPrevWeek:N,onNextWeek:h},null,8,["modelValue"]),i.value?(n(),l("div",we,[C(Z)])):f("",!0),i.value?f("",!0):(n(),l("div",xe,[e("div",Te,[(n(!0),l(y,null,$(t.value,p=>(n(),x(ie,{key:p.date,date:p.date},null,8,["date"]))),128))]),e("div",De,[(n(!0),l(y,null,$(t.value,p=>(n(),l("div",{class:"planner__day-column",key:p.date},[(n(!0),l(y,null,$(p.events,(D,M)=>(n(),x(le,{key:M,event:D},null,8,["event"]))),128))]))),128)),(n(),l(y,null,$(O,(p,D)=>e("div",{class:"planner__line",key:D,style:T({top:`${p.percent}%`})},[e("div",Le,v(p.time),1)],4)),64)),e("div",{class:"planner__line planner__line--now",style:T({top:`${o.value.styleTop}`}),ref_key:"timeLineEl",ref:c},[e("div",Ve,v(o.value.caption),1)],4)])]))]),S(W)?(n(),x($e,{key:0,isOpened:a.value},null,8,["isOpened"])):f("",!0)]))}};export{Ee as default};
