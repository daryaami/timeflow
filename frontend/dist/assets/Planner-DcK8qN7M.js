import{_ as B,o as t,c as a,b as e,n as b,e as d,g as y,f as L,h as k,t as v,i as m,j as w,k as C,l as H,m as V,F as $,p as f,q as g,a as S,u as x,s as D,v as N}from"./index-D8QbICb7.js";const F={props:{isSidebarHidden:Boolean},emits:{"update:isSidebarHidden":Boolean}},I={class:"planner-header"},P={class:"planner-header__date"},R=e("span",null,"February 2024",-1),j=e("div",{class:"planner-header__date-buttons"},[e("button",{class:"planner-header__date-button planner-header__date-button--prev"}),e("button",{class:"planner-header__date-button planner-header__date-button--next"})],-1);function z(r,s,n,i,c,o){return t(),a("header",I,[e("div",P,[R,j,e("button",{class:b(["sidebar-hide",{rotated:n.isSidebarHidden}]),onClick:s[0]||(s[0]=_=>r.$emit("update:isSidebarHidden",!n.isSidebarHidden))},null,2)])])}const M=B(F,[["render",z]]),X={},q={class:"loading-container"},U=e("div",{class:"loading-progress"},null,-1),A=[U];function G(r,s){return t(),a("div",q,A)}const J=B(X,[["render",G]]),K={key:0,class:"event-card__short-wrapper"},O={class:"event-card__name"},Q={class:"event-card__time"},W={class:"event-card__name-wrapper"},Y={key:1,class:"event-card__time"},Z={__name:"EventCard",props:["event"],setup(r){const s=r,n=d(y(s.event.end.dateTime)-y(s.event.start.dateTime)),i=d(L(s.event.start.dateTime)),c=k(()=>y(s.event.start.dateTime)*100/24),o=k(()=>n.value*100/24),_=k(()=>`${i.value} - ${L(s.event.end.dateTime)}`);return console.log(n.value),(h,l)=>(t(),a("div",{class:b(["event-card",{"no-padding":n.value<=.25,"no-right-padding":n.value<=.5}]),style:w({top:`${c.value}%`,height:`calc(${o.value}% - 2px)`,backgroundColor:`${r.event.background_color}`,color:`${r.event.foreground_color}`})},[n.value<=.5?(t(),a("div",K,[e("span",O,v(r.event.summary)+", ",1),e("span",Q,v(i.value),1)])):m("",!0),e("div",W,[n.value>.5?(t(),a("span",{key:0,class:b(["event-card__name",{"one-string":n.value<=1}])},v(r.event.summary),3)):m("",!0)]),n.value>.5?(t(),a("span",Y,v(_.value),1)):m("",!0)],6))}},ee=async()=>{let r=await fetch(`${window.location.origin}/planner_api/get_events/`);if(r.ok)return(await r.json()).days;throw new Error("Failed to fetch events")},te={__name:"PlannerDate",props:["date"],setup(r){const s=r,[n,i,c]=s.date.split(".").map(Number),o=new Date(c,i-1,n),_=k(()=>`${o.toLocaleDateString("en-EN",{weekday:"short"})} ${o.getDate()}`),h=k(()=>new Date().getDate()===o.getDate());return(l,u)=>(t(),a("span",{class:b(["planner-date",{current:h.value}])},v(_.value),3))}},ne={class:"task"},se=["for"],ae=["id"],re={__name:"TaskItem",props:["task"],setup(r){return(s,n)=>(t(),a("div",ne,[e("span",{class:"task__color",style:w({backgroundColor:r.task.color})},null,4),e("label",{class:"task__checkbox-label",for:s.title},[e("input",{class:"visually-hidden",id:s.title,type:"checkbox"},null,8,ae)],8,se),e("span",null,v(r.task.name),1)]))}},oe={class:"right-sidebar"},le={class:"right-sidebar__tabs"},ie=e("span",null,"Habits",-1),ce=[ie],de=e("span",null,"Tasks",-1),_e=[de],ue={class:"underline"},pe={key:0,class:"tasks"},ve={__name:"RightSidebar",setup(r){const s=d(),n=d(),i=d(null),c=d(null),o=d(null),_=d(C.value.tasks);return H(()=>{console.log(i)}),V(o,()=>{s.value.style.transform=`translateX(${o.value.offsetLeft}px)`,n.value.style.transform=`translateX(${o.value.offsetLeft}px)`}),o.value=c.value,(h,l)=>(t(),a("div",oe,[e("div",le,[e("button",{ref_key:"habitsButton",ref:i,class:"right-sidebar__tab",onClick:l[0]||(l[0]=u=>o.value=i.value)},ce,512),e("button",{ref_key:"tasksButton",ref:c,class:"right-sidebar__tab",onClick:l[1]||(l[1]=u=>o.value=c.value)},_e,512),e("div",ue,[e("div",{ref_key:"underlineRight",ref:s,class:"underline__closer underline__closer--right"},null,512),e("div",{ref_key:"underlineLeft",ref:n,class:"underline__closer underline__closer--left"},null,512)])]),o.value===c.value?(t(),a("div",pe,[(t(!0),a($,null,f(_.value,u=>(t(),g(re,{key:u.id,task:u},null,8,["task"]))),128))])):m("",!0)]))}},me={class:"planner-wrapper"},he={class:"planner"},$e={key:0,class:"planner__loader-wrapper"},fe={key:1,class:"planner__grid-wrapper"},ke={class:"planner__days-header"},ye={class:"planner__grid"},ge={class:"planner__line-time"},be={class:"planner__line-time"},Te={__name:"Planner",setup(r){const s=d(null),n=d({caption:"",styleTop:""}),i=()=>{const l=new Date;n.value.caption=L(l),n.value.styleTop=`${y(l)*100/24}%`},c=async()=>{i(),await N(),s.value.scrollIntoView({block:"center"});const u=(60-new Date().getSeconds())*1e3;setTimeout(()=>{i(),setInterval(i,6e4)},u)},o=d(!0),_=async()=>{try{D.value=await ee()}catch(l){console.error("ошибка",l)}finally{o.value=!1,c()}};H(()=>{_()});const h=[{time:"01:00",percent:100/24},{time:"02:00",percent:200/24},{time:"03:00",percent:300/24},{time:"04:00",percent:400/24},{time:"05:00",percent:500/24},{time:"06:00",percent:600/24},{time:"07:00",percent:700/24},{time:"08:00",percent:800/24},{time:"09:00",percent:900/24},{time:"10:00",percent:1e3/24},{time:"11:00",percent:1100/24},{time:"12:00",percent:1200/24},{time:"13:00",percent:1300/24},{time:"14:00",percent:1400/24},{time:"15:00",percent:1500/24},{time:"16:00",percent:1600/24},{time:"17:00",percent:1700/24},{time:"18:00",percent:1800/24},{time:"19:00",percent:1900/24},{time:"20:00",percent:2e3/24},{time:"21:00",percent:2100/24},{time:"22:00",percent:2200/24},{time:"23:00",percent:2300/24}];return(l,u)=>(t(),a("div",me,[e("div",he,[S(M),o.value?(t(),a("div",$e,[S(J)])):m("",!0),o.value?m("",!0):(t(),a("div",fe,[e("div",ke,[(t(!0),a($,null,f(x(D),p=>(t(),g(te,{key:p.date,date:p.date},null,8,["date"]))),128))]),e("div",ye,[(t(!0),a($,null,f(x(D),p=>(t(),a("div",{class:"planner__day-column",key:p.date},[(t(!0),a($,null,f(p.events,(T,E)=>(t(),g(Z,{key:E,event:T},null,8,["event"]))),128))]))),128)),(t(),a($,null,f(h,(p,T)=>e("div",{class:"planner__line",key:T,style:w({top:`${p.percent}%`})},[e("div",ge,v(p.time),1)],4)),64)),e("div",{class:"planner__line planner__line--now",style:w({top:`${n.value.styleTop}`}),ref_key:"timeLineEl",ref:s},[e("div",be,v(n.value.caption),1)],4)])]))]),x(C)?(t(),g(ve,{key:0})):m("",!0)]))}};export{Te as default};
