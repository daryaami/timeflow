import{e as $,f as p,g as x,h as z,r as F,o as n,i as w,w as q,c as i,b as e,t as y,j as k,n as b,k as E,l as N,m as B,F as T,p as C,u as I,q as P,s as X,v as j,x as A,_ as R,a as M,y as J,z as U,A as G,B as Y,C as W,D as Z}from"./index-BpJCuzWv.js";const K={key:0,class:"event-card__short-wrapper"},Q={class:"event-card__name"},ee={class:"event-card__time"},te={class:"event-card__name-wrapper"},ne={key:1,class:"event-card__time"},ae={__name:"EventCard",props:["event","gridHeight"],setup(a){const s=a,t=$(()=>(new Date(s.event.end.dateTime)-new Date(s.event.start.dateTime))/(1e3*60*60)),l=p(x(s.event.start.dateTime)),m=p(),c=$(()=>z(s.event.start.dateTime)*100/24),d=$(()=>Math.max(t.value,.25)*100/24),v=$(()=>`${l.value} - ${x(s.event.end.dateTime)}`),f=$(()=>new Date(s.event.end.dateTime)<new Date),h=$(()=>s.gridHeight?[10,s.gridHeight/96]:[0,0]),D=$(()=>s.event.overlapLevel?s.event.overlapLevel+1:1);return(r,o)=>{const u=F("vue-draggable-resizable");return a.gridHeight?(n(),w(u,{key:0,class:b(["event-card",{"no-padding":t.value<=.25,"no-right-padding":t.value<=.5,past:f.value,overlap:a.event.overlapLevel}]),axis:"y",grid:h.value,handles:["tm","bm"],active:!0,style:E({top:`${c.value}%`,height:`calc(${d.value}% - 2px)`,backgroundColor:`${a.event.background_color}`,color:`${a.event.foreground_color}`,width:`calc(100% - ${D.value*.75}rem)`}),ref_key:"card",ref:m},{default:q(()=>[t.value<.75?(n(),i("div",K,[e("span",Q,y(a.event.summary)+", ",1),e("span",ee,y(l.value),1)])):k("",!0),e("div",te,[t.value>=.75?(n(),i("span",{key:0,class:b(["event-card__name",{"one-string":t.value<=1}])},y(a.event.summary),3)):k("",!0)]),t.value>=.75?(n(),i("span",ne,y(v.value),1)):k("",!0)]),_:1},8,["grid","style","class"])):k("",!0)}}},se=[{time:"01:00",percent:100/24},{time:"02:00",percent:200/24},{time:"03:00",percent:300/24},{time:"04:00",percent:400/24},{time:"05:00",percent:500/24},{time:"06:00",percent:600/24},{time:"07:00",percent:700/24},{time:"08:00",percent:800/24},{time:"09:00",percent:900/24},{time:"10:00",percent:1e3/24},{time:"11:00",percent:1100/24},{time:"12:00",percent:1200/24},{time:"13:00",percent:1300/24},{time:"14:00",percent:1400/24},{time:"15:00",percent:1500/24},{time:"16:00",percent:1600/24},{time:"17:00",percent:1700/24},{time:"18:00",percent:1800/24},{time:"19:00",percent:1900/24},{time:"20:00",percent:2e3/24},{time:"21:00",percent:2100/24},{time:"22:00",percent:2200/24},{time:"23:00",percent:2300/24}],re={class:"planner__line-time"},le={class:"planner__line-time"},oe={__name:"PlannerGrid",props:["days","selectedEvent"],emits:["eventClick"],setup(a,{emit:s}){const t=s,l=p(null),m=p(),c=p(null),d=p(null),v=p({caption:"",styleTop:""}),f=()=>{d.value.style.display="none";const r=document.querySelector(".planner-date.current");if(!r)return;const o=(r.getBoundingClientRect().left-c.value.getBoundingClientRect().left)/c.value.offsetWidth*100,u=r.offsetWidth*.9/c.value.offsetWidth*100;d.value.style.left=`${o}%`,d.value.style.width=`${u}%`,d.value.style.display="block"},h=()=>{const r=new Date;v.value.caption=x(r),v.value.styleTop=`${z(r)*100/24}%`},D=async()=>{h(),await B(),f(),c.value.scrollIntoView({block:"center"});const o=(60-new Date().getSeconds())*1e3;setTimeout(()=>{h(),setInterval(h,6e4)},o)};return N(async()=>{await B(),D(),m.value=l.value.offsetHeight}),(r,o)=>(n(),i("div",{class:"planner__grid",ref_key:"grid",ref:l},[(n(!0),i(T,null,C(a.days,u=>(n(),i("div",{class:"planner__day-column",key:u.date},[(n(!0),i(T,null,C(u.events,(_,g)=>(n(),w(ae,{key:g,event:_,gridHeight:m.value,onClick:S=>t("eventClick",_),class:b({selected:a.selectedEvent===_})},null,8,["event","gridHeight","onClick","class"]))),128))]))),128)),(n(!0),i(T,null,C(I(se),(u,_)=>(n(),i("div",{class:"planner__line",key:_,style:E({top:`${u.percent}%`})},[e("div",re,y(u.time),1)],4))),128)),e("div",{class:"planner__line planner__line--now",style:E({top:`${v.value.styleTop}`}),ref_key:"timeLineEl",ref:c},[e("div",le,y(v.value.caption),1),e("div",{class:"planner__line-today-line",ref_key:"todayLine",ref:d},null,512)],4)],512))}},ie={class:"planner-header"},ce={class:"planner-header__date"},de={class:"planner-header__buttons"},ue={__name:"PlannerHeader",props:P(["isSidebarOpened","currentMonth"],{modelValue:{},modelModifiers:{}}),emits:P(["prevWeek","nextWeek"],["update:modelValue"]),setup(a,{emit:s}){const t=s,l=X(a,"modelValue");return(m,c)=>(n(),i("header",ie,[e("span",ce,y(a.currentMonth),1),e("div",de,[e("button",{class:"planner-header__date-button planner-header__date-button--prev icon-button",onClick:c[0]||(c[0]=d=>t("prevWeek"))}),e("button",{class:"planner-header__date-button planner-header__date-button--next icon-button",onClick:c[1]||(c[1]=d=>t("nextWeek"))})]),e("label",{class:b(["sidebar-hide icon-button",{rotated:!l.value}])},[j(e("input",{type:"checkbox",class:"visually-hidden","onUpdate:modelValue":c[2]||(c[2]=d=>l.value=d)},null,512),[[A,l.value]])],2)]))}},_e={},ve={class:"loading-container"},pe=e("div",{class:"loading-progress"},null,-1),me=[pe];function he(a,s){return n(),i("div",ve,me)}const ye=R(_e,[["render",he]]),fe={},ge={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ke=e("path",{d:"M20.7457 3.32854C20.3552 2.93801 19.722 2.93801 19.3315 3.32854L12.0371 10.6229L4.74275 3.32854C4.35223 2.93801 3.71906 2.93801 3.32854 3.32854C2.93801 3.71906 2.93801 4.35223 3.32854 4.74275L10.6229 12.0371L3.32856 19.3314C2.93803 19.722 2.93803 20.3551 3.32856 20.7457C3.71908 21.1362 4.35225 21.1362 4.74277 20.7457L12.0371 13.4513L19.3315 20.7457C19.722 21.1362 20.3552 21.1362 20.7457 20.7457C21.1362 20.3551 21.1362 19.722 20.7457 19.3315L13.4513 12.0371L20.7457 4.74275C21.1362 4.35223 21.1362 3.71906 20.7457 3.32854Z",fill:"currentColor"},null,-1),$e=[ke];function De(a,s){return n(),i("svg",ge,$e)}const we=R(fe,[["render",De]]),be={class:"event-info-sidebar"},Te={class:"event-info-sidebar__buttons-wrapper"},Ce={class:"event-info-sidebar__event-title"},xe={class:"event-characteristics"},Le=e("span",{class:"event-characteristics__name"},"Duration",-1),Me={class:"event-characteristics__value"},Ee=e("span",{class:"event-characteristics__name"},"Dates",-1),Se={class:"event-characteristics__value"},He={key:0},Ve=e("span",{class:"event-characteristics__name"},"Calendar",-1),We={class:"event-characteristics__value"},Be={__name:"EventInfoSidebar",props:["event"],emits:["close"],setup(a,{emit:s}){const t=a,l=s,m=$(()=>{const d=new Date(t.event.start.dateTime),f=new Date(t.event.end.dateTime)-d,h=Math.floor(f/(1e3*60*60)),D=Math.floor(f%(1e3*60*60)/(1e3*60));return`${h} hr${h>1?"s":""}${D>0?` ${D} min`:""}`}),c=$(()=>{const d=new Date(t.event.start.dateTime),v=new Date(t.event.end.dateTime);return`${d.getDate()}/${d.getMonth()} ${x(d)} - ${x(v)}`});return(d,v)=>(n(),i("div",be,[e("div",Te,[e("button",{class:"event-info-sidebar__button icon-button",onClick:v[0]||(v[0]=f=>l("close"))},[M(we)])]),e("span",Ce,y(a.event.summary),1),e("ul",xe,[e("li",null,[Le,e("span",Me,y(m.value),1)]),e("li",null,[Ee,e("span",Se,y(c.value),1)]),a.event.calendar?(n(),i("li",He,[Ve,e("span",We,y(a.event.calendar),1)])):k("",!0)])]))}},Ne={class:"planner-date__weekday"},Oe={class:"planner-date__day"},Pe={__name:"PlannerDate",props:["day"],setup(a){return(s,t)=>(n(),i("div",{class:b(["planner-date",{current:a.day.isToday}])},[e("span",Ne,y(a.day.weekday),1),e("div",Oe,[e("span",null,y(a.day.date),1)])],2))}},ze={class:"task"},Ie=["for"],Re=["id"],Je={__name:"TaskItem",props:["task"],setup(a){return(s,t)=>(n(),i("div",ze,[e("span",{class:"task__color",style:E({backgroundColor:a.task.color})},null,4),e("label",{class:"task__checkbox-label",for:s.title},[e("input",{class:"visually-hidden",id:s.title,type:"checkbox"},null,8,Re)],8,Ie),e("span",null,y(a.task.name),1)]))}},Ue={class:"right-sidebar"},Fe={class:"right-sidebar__tabs"},qe=e("span",null,"Tasks",-1),Xe=[qe],je={class:"underline"},Ae={key:0,class:"tasks"},Ge={__name:"RightSidebar",setup(a){const s=p(),t=p();p(null);const l=p(null),m=p(null),c=p(J.value.tasks);return N(()=>{m.value=l.value}),U(m,()=>{s.value.style.transform=`translateX(${m.value.offsetLeft}px)`,t.value.style.transform=`translateX(${m.value.offsetLeft}px)`}),(d,v)=>(n(),i("div",Ue,[e("div",Fe,[e("button",{ref_key:"tasksButton",ref:l,class:"right-sidebar__tab",onClick:v[0]||(v[0]=f=>m.value=l.value)},Xe,512),e("div",je,[e("div",{ref_key:"underlineRight",ref:s,class:"underline__closer underline__closer--right"},null,512),e("div",{ref_key:"underlineLeft",ref:t,class:"underline__closer underline__closer--left"},null,512)])]),m.value===l.value?(n(),i("div",Ae,[(n(!0),i(T,null,C(c.value,f=>(n(),w(Je,{key:f.id,task:f},null,8,["task"]))),128))])):k("",!0)]))}},Ye={class:"planner-wrapper"},Ze={class:"planner"},Ke={key:0,class:"planner__loader-wrapper"},Qe={key:1,class:"planner__grid-wrapper"},et={class:"planner__days-header"},at={__name:"Planner",setup(a){const s=p(!0),t=p([]),l=p(!0),m=(r,o)=>{const u=Y(r);t.value=[];for(let _=0;_<7;_++){const g=new Date(u);g.setDate(u.getDate()+_),t.value.push({weekday:g.toLocaleDateString("en-EN",{weekday:"short"}),date:g.getDate(),isToday:W(g,new Date),day:g,events:[]})}o.forEach(_=>{const g=new Date(_.start.dateTime),S=new Date(_.end.dateTime);if(g.getDate()===S.getDate())t.value.find(O=>O.date===g.getDate()).events.push(_);else{const L=JSON.parse(JSON.stringify(_));L.end.dateTime=L.start.dateTime.replace(/T\d{2}:\d{2}:\d{2}/,"T23:59:00"),t.value.find(V=>V.date===g.getDate()).events.push(L);const H=JSON.parse(JSON.stringify(_));H.start.dateTime=H.end.dateTime.replace(/T\d{2}:\d{2}:\d{2}/,"T00:00:00"),t.value.find(V=>V.date===S.getDate()).events.push(H)}})},c=async(r=new Date)=>{try{const o=await G(r);m(r,o)}catch(o){console.error("ошибка",o)}finally{l.value=!1,await B()}},d=async()=>{if(l.value)return;l.value=!0;const r=t.value[0].day,o=new Date(r.setDate(r.getDate()+7));c(o)},v=async()=>{if(l.value)return;l.value=!0;const r=t.value[0].day,o=new Date(r.setDate(r.getDate()-7));c(o)},f=$(()=>{if(t.value.length){const r=t.value[0].day;return`${r.toLocaleString("default",{month:"long"})} ${r.getFullYear()}`}else return""});N(()=>{c()}),U(Z,r=>{r.forEach(o=>{const u=t.value.find(_=>W(_.day,new Date(o.start.dateTime))||W(_.day,new Date(o.end.dateTime)));u&&u.events.push(o)})});const h=p(null),D=r=>{h.value=r};return(r,o)=>(n(),i("div",Ye,[e("div",Ze,[M(ue,{modelValue:s.value,"onUpdate:modelValue":o[0]||(o[0]=u=>s.value=u),currentMonth:f.value,onPrevWeek:v,onNextWeek:d},null,8,["modelValue","currentMonth"]),l.value?(n(),i("div",Ke,[M(ye)])):k("",!0),l.value?k("",!0):(n(),i("div",Qe,[e("div",et,[(n(!0),i(T,null,C(t.value,u=>(n(),w(Pe,{key:u.date,day:u},null,8,["day"]))),128))]),M(oe,{days:t.value,selectedEvent:h.value,onEventClick:D},null,8,["days","selectedEvent"])]))]),I(J)?(n(),i("div",{key:0,class:b(["planner__right-sidebar",{hidden:!s.value}])},[h.value?k("",!0):(n(),w(Ge,{key:0})),h.value?(n(),w(Be,{key:1,event:h.value,onClose:o[1]||(o[1]=u=>h.value=null)},null,8,["event"])):k("",!0)],2)):k("",!0)]))}};export{at as default};
