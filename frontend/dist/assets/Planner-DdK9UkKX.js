import{e as w,f as h,g as W,h as O,r as A,o as a,i as x,w as G,c,b as e,t as f,j as b,n as M,k as H,l as F,m as Y,p as I,q as P,F as E,s as S,u as N,v as R,x as Z,y as J,z as K,_ as U,a as z,A as j,B as q,C as Q,D as ee}from"./index-DswEQFKL.js";const te={key:0,class:"event-card__short-wrapper"},ne={class:"event-card__name"},ae={class:"event-card__time"},se={class:"event-card__name-wrapper"},re={key:1,class:"event-card__time"},le={__name:"EventCard",props:["card","gridHeight"],setup(s){const n=s,r=w(()=>(new Date(n.card.end)-new Date(n.card.start))/(1e3*60*60)),l=h(W(n.card.event.start.dateTime)),d=w(()=>O(n.card.start)*100/24),u=w(()=>Math.max(r.value,.25)*100/24),v=w(()=>`${l.value} - ${W(n.card.event.end.dateTime)}`),o=w(()=>new Date(n.card.event.end.dateTime)<new Date),_=w(()=>n.gridHeight?[10,n.gridHeight/96]:[0,0]),p=w(()=>n.card.overlapLevel?n.card.overlapLevel+1:1);return($,g)=>{const k=A("vue-draggable-resizable");return s.gridHeight?(a(),x(k,{key:0,class:M(["event-card",{"no-padding":r.value<=.25,"no-right-padding":r.value<=.5,past:o.value,overlap:s.card.overlapLevel}]),axis:"y",grid:_.value,handles:["tm","bm"],active:!0,style:H({top:`${d.value}%`,height:`calc(${u.value}% - 2px)`,backgroundColor:`${s.card.event.background_color}`,color:`${s.card.event.foreground_color}`,width:`calc(100% - ${p.value*.75}rem)`})},{default:G(()=>[r.value<.75?(a(),c("div",te,[e("span",ne,f(s.card.event.summary)+", ",1),e("span",ae,f(l.value),1)])):b("",!0),e("div",se,[r.value>=.75?(a(),c("span",{key:0,class:M(["event-card__name",{"one-string":r.value<=1}])},f(s.card.event.summary),3)):b("",!0)]),r.value>=.75?(a(),c("span",re,f(v.value),1)):b("",!0)]),_:1},8,["grid","style","class"])):b("",!0)}}},oe=[{time:"01:00",percent:100/24},{time:"02:00",percent:200/24},{time:"03:00",percent:300/24},{time:"04:00",percent:400/24},{time:"05:00",percent:500/24},{time:"06:00",percent:600/24},{time:"07:00",percent:700/24},{time:"08:00",percent:800/24},{time:"09:00",percent:900/24},{time:"10:00",percent:1e3/24},{time:"11:00",percent:1100/24},{time:"12:00",percent:1200/24},{time:"13:00",percent:1300/24},{time:"14:00",percent:1400/24},{time:"15:00",percent:1500/24},{time:"16:00",percent:1600/24},{time:"17:00",percent:1700/24},{time:"18:00",percent:1800/24},{time:"19:00",percent:1900/24},{time:"20:00",percent:2e3/24},{time:"21:00",percent:2100/24},{time:"22:00",percent:2200/24},{time:"23:00",percent:2300/24}],ce={class:"planner-date__weekday"},ie={class:"planner-date__day"},de={__name:"PlannerDate",props:["day"],setup(s){return(n,r)=>(a(),c("div",{class:M(["planner-date",{current:s.day.isToday}])},[e("span",ce,f(s.day.weekday),1),e("div",ie,[e("span",null,f(s.day.date),1)])],2))}},ue={class:"planner__grid-wrapper"},ve={class:"planner__days-header"},_e={class:"planner__line-time"},pe={class:"planner__line-time"},me={__name:"PlannerGrid",props:["events","currentDate","selectedEvent"],emits:["cardClick"],setup(s,{emit:n}){const r=s,l=n,d=y=>{const m=y.sort((t,i)=>new Date(t.start)-new Date(i.start));for(let t=1;t<m.length;t++){const i=m[t],L=new Date(i.start);for(let C=t-1;C>=0;C--){const D=m[C];if(L>new Date(D.start)&&L<new Date(D.end)){D.overlapLevel?i.overlapLevel=D.overlapLevel+1:i.overlapLevel=1;break}}}return m},u=w(()=>{const y=F(r.currentDate),m=[];for(let t=0;t<7;t++){const i=new Date(y);i.setDate(y.getDate()+t),m.push({weekday:i.toLocaleDateString("en-EN",{weekday:"short"}),date:i.getDate(),isToday:Y(i,new Date),day:i,cards:[]})}return r.events.forEach(t=>{if(!t.start.dateTime)return;const i=new Date(t.start.dateTime),L=new Date(t.end.dateTime);if(i.getDate()===L.getDate()){const C=m.find(V=>V.date===i.getDate());if(!C)return;const D={event:t,start:t.start.dateTime,end:t.end.dateTime};C.cards.push(D)}else{const C={event:t,start:t.start.dateTime,end:t.start.dateTime.replace(/T\d{2}:\d{2}:\d{2}/,"T23:59:00")},D=m.find(B=>B.date===i.getDate());D&&D.cards.push(C);const V={event:t,start:t.end.dateTime.replace(/T\d{2}:\d{2}:\d{2}/,"T00:00:00"),end:t.end.dateTime},X=m.find(B=>B.date===L.getDate());D&&X.cards.push(V)}}),m.forEach(t=>t.cards=d(t.cards)),m}),v=h(null),o=h(),_=h(null),p=h(null),$=h({caption:"",styleTop:""}),g=()=>{p.value.style.display="none";const y=document.querySelector(".planner-date.current");if(!y)return;const m=(y.getBoundingClientRect().left-_.value.getBoundingClientRect().left)/_.value.offsetWidth*100,t=y.offsetWidth*.9/_.value.offsetWidth*100;p.value.style.left=`${m}%`,p.value.style.width=`${t}%`,p.value.style.display="block"},k=()=>{const y=new Date;$.value.caption=W(y),$.value.styleTop=`${O(y)*100/24}%`},T=async()=>{k(),await P(),g(),_.value.scrollIntoView({block:"center"});const m=(60-new Date().getSeconds())*1e3;setTimeout(()=>{k(),setInterval(k,6e4)},m)};return I(async()=>{await P(),T(),o.value=v.value.offsetHeight}),(y,m)=>(a(),c("div",ue,[e("div",ve,[(a(!0),c(E,null,S(u.value,t=>(a(),x(de,{key:t.date,day:t},null,8,["day"]))),128))]),e("div",{class:"planner__grid",ref_key:"grid",ref:v},[(a(!0),c(E,null,S(u.value,t=>(a(),c("div",{class:"planner__day-column",key:t.date},[(a(!0),c(E,null,S(t.cards,(i,L)=>(a(),x(le,{key:L,card:i,gridHeight:o.value,onClick:C=>l("cardClick",i.event),class:M({selected:s.selectedEvent===i.event})},null,8,["card","gridHeight","onClick","class"]))),128))]))),128)),(a(!0),c(E,null,S(N(oe),(t,i)=>(a(),c("div",{class:"planner__line",key:i,style:H({top:`${t.percent}%`})},[e("div",_e,f(t.time),1)],4))),128)),e("div",{class:"planner__line planner__line--now",style:H({top:`${$.value.styleTop}`}),ref_key:"timeLineEl",ref:_},[e("div",pe,f($.value.caption),1),e("div",{class:"planner__line-today-line",ref_key:"todayLine",ref:p},null,512)],4)],512)]))}},he={class:"planner-header"},fe={class:"planner-header__date"},ye={class:"planner-header__buttons"},ge={__name:"PlannerHeader",props:R(["isSidebarOpened","currentMonth"],{modelValue:{},modelModifiers:{}}),emits:R(["prevWeek","nextWeek","updateEvents"],["update:modelValue"]),setup(s,{emit:n}){const r=n,l=Z(s,"modelValue");return(d,u)=>(a(),c("header",he,[e("span",fe,f(s.currentMonth),1),e("div",ye,[e("button",{class:"planner-header__date-button planner-header__date-button--prev icon-button",onClick:u[0]||(u[0]=v=>r("prevWeek"))}),e("button",{class:"planner-header__date-button planner-header__date-button--next icon-button",onClick:u[1]||(u[1]=v=>r("nextWeek"))})]),e("label",{class:M(["sidebar-hide icon-button",{rotated:!l.value}])},[J(e("input",{type:"checkbox",class:"visually-hidden","onUpdate:modelValue":u[2]||(u[2]=v=>l.value=v)},null,512),[[K,l.value]])],2)]))}},ke={},$e={class:"loading-container"};function we(s,n){return a(),c("div",$e,n[0]||(n[0]=[e("div",{class:"loading-progress"},null,-1)]))}const be=U(ke,[["render",we]]),De={},Ce={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Te(s,n){return a(),c("svg",Ce,n[0]||(n[0]=[e("path",{d:"M20.7457 3.32854C20.3552 2.93801 19.722 2.93801 19.3315 3.32854L12.0371 10.6229L4.74275 3.32854C4.35223 2.93801 3.71906 2.93801 3.32854 3.32854C2.93801 3.71906 2.93801 4.35223 3.32854 4.74275L10.6229 12.0371L3.32856 19.3314C2.93803 19.722 2.93803 20.3551 3.32856 20.7457C3.71908 21.1362 4.35225 21.1362 4.74277 20.7457L12.0371 13.4513L19.3315 20.7457C19.722 21.1362 20.3552 21.1362 20.7457 20.7457C21.1362 20.3551 21.1362 19.722 20.7457 19.3315L13.4513 12.0371L20.7457 4.74275C21.1362 4.35223 21.1362 3.71906 20.7457 3.32854Z",fill:"currentColor"},null,-1)]))}const Le=U(De,[["render",Te]]),xe={class:"event-info-sidebar"},Me={class:"event-info-sidebar__buttons-wrapper"},Ee={class:"event-info-sidebar__event-title"},Se={class:"event-characteristics"},We={class:"event-characteristics__value"},He={class:"event-characteristics__value"},Ve={key:0},Be={class:"event-characteristics__value"},Pe={__name:"EventInfoSidebar",props:["event"],emits:["close"],setup(s,{emit:n}){const r=s,l=n,d=w(()=>{const v=new Date(r.event.start.dateTime),_=new Date(r.event.end.dateTime)-v,p=Math.floor(_/(1e3*60*60)),$=Math.floor(_%(1e3*60*60)/(1e3*60));return`${p} hr${p>1?"s":""}${$>0?` ${$} min`:""}`}),u=w(()=>{const v=new Date(r.event.start.dateTime),o=new Date(r.event.end.dateTime);return`${v.getDate()}/${v.getMonth()} ${W(v)} - ${W(o)}`});return(v,o)=>(a(),c("div",xe,[e("div",Me,[e("button",{class:"event-info-sidebar__button icon-button",onClick:o[0]||(o[0]=_=>l("close"))},[z(Le)])]),e("span",Ee,f(s.event.summary),1),e("ul",Se,[e("li",null,[o[1]||(o[1]=e("span",{class:"event-characteristics__name"},"Duration",-1)),e("span",We,f(d.value),1)]),e("li",null,[o[2]||(o[2]=e("span",{class:"event-characteristics__name"},"Dates",-1)),e("span",He,f(u.value),1)]),s.event.calendar?(a(),c("li",Ve,[o[3]||(o[3]=e("span",{class:"event-characteristics__name"},"Calendar",-1)),e("span",Be,f(s.event.calendar),1)])):b("",!0)])]))}},Ne={class:"task"},ze=["for"],Ie=["id"],Re={__name:"TaskItem",props:["task"],setup(s){return(n,r)=>(a(),c("div",Ne,[e("span",{class:"task__color",style:H({backgroundColor:s.task.color})},null,4),e("label",{class:"task__checkbox-label",for:n.title},[e("input",{class:"visually-hidden",id:n.title,type:"checkbox"},null,8,Ie)],8,ze),e("span",null,f(s.task.name),1)]))}},Oe={class:"right-sidebar"},Fe={class:"right-sidebar__tabs"},Ue={class:"underline"},je={key:0,class:"tasks"},qe={__name:"RightSidebar",setup(s){const n=h(),r=h();h(null);const l=h(null),d=h(null),u=h(j.value.tasks);return I(()=>{d.value=l.value}),q(d,()=>{n.value.style.transform=`translateX(${d.value.offsetLeft}px)`,r.value.style.transform=`translateX(${d.value.offsetLeft}px)`}),(v,o)=>(a(),c("div",Oe,[e("div",Fe,[e("button",{ref_key:"tasksButton",ref:l,class:"right-sidebar__tab",onClick:o[0]||(o[0]=_=>d.value=l.value)},o[1]||(o[1]=[e("span",null,"Tasks",-1)]),512),e("div",Ue,[e("div",{ref_key:"underlineRight",ref:n,class:"underline__closer underline__closer--right"},null,512),e("div",{ref_key:"underlineLeft",ref:r,class:"underline__closer underline__closer--left"},null,512)])]),d.value===l.value?(a(),c("div",je,[(a(!0),c(E,null,S(u.value,_=>(a(),x(Re,{key:_.id,task:_},null,8,["task"]))),128))])):b("",!0)]))}},Xe={class:"planner-wrapper"},Ae={class:"planner"},Ge={key:0,class:"planner__loader-wrapper"},Ze={__name:"Planner",setup(s){const n=h(!0),r=h(),l=Q(),d=h(!0),u=async g=>{d.value=!0;const k=F(g);try{const T=await ee.get(k);r.value=T}catch(T){console.error("ошибка",T)}finally{d.value=!1,await P()}},v=async()=>{d.value||l.toNextWeek()},o=async()=>{d.value||l.toPrevWeek()};q(l,g=>{u(g.date)});const _=w(()=>{if(l.date){const g=l.date;return`${g.toLocaleString("default",{month:"long"})} ${g.getFullYear()}`}else return""});I(()=>{u(l.date)});const p=h(null),$=g=>{p.value=g};return(g,k)=>(a(),c("div",Xe,[e("div",Ae,[z(ge,{modelValue:n.value,"onUpdate:modelValue":k[0]||(k[0]=T=>n.value=T),currentMonth:_.value,onPrevWeek:o,onNextWeek:v},null,8,["modelValue","currentMonth"]),d.value?(a(),c("div",Ge,[z(be)])):b("",!0),d.value?b("",!0):(a(),x(me,{key:1,events:r.value,"current-date":N(l).date,selectedEvent:p.value,onCardClick:$},null,8,["events","current-date","selectedEvent"]))]),N(j)?(a(),c("div",{key:0,class:M(["planner__right-sidebar",{hidden:!n.value}])},[p.value?b("",!0):(a(),x(qe,{key:0})),p.value?(a(),x(Pe,{key:1,event:p.value,onClose:k[1]||(k[1]=T=>p.value=null)},null,8,["event"])):b("",!0)],2)):b("",!0)]))}};export{Ze as default};
