import{_ as S,o as n,c as s,b as t,n as L,e as p,t as u,f as w,g as $,h as b,i as m,j as H,a as T,k as x,F as v,l as h,m as D,p as B}from"./index-BASbP0L6.js";const V={props:{isSidebarHidden:Boolean},emits:{"update:isSidebarHidden":Boolean}},C={class:"planner-header"},N={class:"planner-header__date"},F=t("span",null,"February 2024",-1),P=t("div",{class:"planner-header__date-buttons"},[t("button",{class:"planner-header__date-button planner-header__date-button--prev"}),t("button",{class:"planner-header__date-button planner-header__date-button--next"})],-1);function j(a,e,r,c,_,o){return n(),s("header",C,[t("div",N,[F,P,t("button",{class:L(["sidebar-hide",{rotated:r.isSidebarHidden}]),onClick:e[0]||(e[0]=l=>a.$emit("update:isSidebarHidden",!r.isSidebarHidden))},null,2)])])}const z=S(V,[["render",j]]),I={},M={class:"loading-container"},U=t("div",{class:"loading-progress"},null,-1),q=[U];function A(a,e){return n(),s("div",M,q)}const G=S(I,[["render",A]]),J={class:"event-card__name"},K={class:"event-card__time"},O={__name:"EventCard",props:["event"],setup(a){const e=a,r=p(()=>$(e.event.start.dateTime)*100/24),c=p(()=>($(e.event.end.dateTime)-$(e.event.start.dateTime))*100/24),_=p(()=>`${b(e.event.start.dateTime)} - ${b(e.event.end.dateTime)}`);return(o,l)=>(n(),s("div",{class:"event-card",style:w({top:`${r.value}%`,height:`${c.value}%`,backgroundColor:`${a.event.background_color}`,color:`${a.event.foreground_color}`})},[t("span",J,u(a.event.summary),1),t("span",K,u(_.value),1)],4))}},Q=async()=>{let a=await fetch(`${window.location.origin}/planner_api/get_events/`);if(a.ok)return(await a.json()).days;throw new Error("Failed to fetch events")},R={__name:"PlannerDate",props:["date"],setup(a){const e=a,[r,c,_]=e.date.split(".").map(Number),o=new Date(_,c-1,r),l=p(()=>`${o.toLocaleDateString("en-EN",{weekday:"short"})} ${o.getDate()}`),y=p(()=>new Date().getDate()===o.getDate());return(f,d)=>(n(),s("span",{class:L(["planner-date",{current:y.value}])},u(l.value),3))}},W={class:"planner"},X={key:0,class:"planner__loader-wrapper"},Y={key:1,class:"planner__grid-wrapper"},Z={class:"planner__days-header"},ee={class:"planner__grid"},te={class:"planner__line-time"},ne={class:"planner__line-time"},se={__name:"Planner",setup(a){const e=m(null),r=m({caption:"",styleTop:""}),c=()=>{const d=new Date;r.value.caption=b(d),r.value.styleTop=`${$(d)*100/24}%`},_=async()=>{c(),await B(),e.value.scrollIntoView({block:"center"});const k=(60-new Date().getSeconds())*1e3;setTimeout(()=>{c(),setInterval(c,6e4)},k)},o=m([]),l=m(!0),y=async()=>{try{o.value=await Q()}catch(d){console.error("ошибка",d)}finally{l.value=!1,_()}};H(()=>{y()});const f=[{time:"01:00",percent:100/24},{time:"02:00",percent:200/24},{time:"03:00",percent:300/24},{time:"04:00",percent:400/24},{time:"05:00",percent:500/24},{time:"06:00",percent:600/24},{time:"07:00",percent:700/24},{time:"08:00",percent:800/24},{time:"09:00",percent:900/24},{time:"10:00",percent:1e3/24},{time:"11:00",percent:1100/24},{time:"12:00",percent:1200/24},{time:"13:00",percent:1300/24},{time:"14:00",percent:1400/24},{time:"15:00",percent:1500/24},{time:"16:00",percent:1600/24},{time:"17:00",percent:1700/24},{time:"18:00",percent:1800/24},{time:"19:00",percent:1900/24},{time:"20:00",percent:2e3/24},{time:"21:00",percent:2100/24},{time:"22:00",percent:2200/24},{time:"23:00",percent:2300/24}];return(d,k)=>(n(),s("div",W,[T(z),l.value?(n(),s("div",X,[T(G)])):x("",!0),l.value?x("",!0):(n(),s("div",Y,[t("div",Z,[(n(!0),s(v,null,h(o.value,i=>(n(),D(R,{key:i.date,date:i.date},null,8,["date"]))),128))]),t("div",ee,[(n(!0),s(v,null,h(o.value,i=>(n(),s("div",{class:"planner__day-column",key:i.date},[(n(!0),s(v,null,h(i.events,(g,E)=>(n(),D(O,{key:E,event:g},null,8,["event"]))),128))]))),128)),(n(),s(v,null,h(f,(i,g)=>t("div",{class:"planner__line",key:g,style:w({top:`${i.percent}%`})},[t("div",te,u(i.time),1)],4)),64)),t("div",{class:"planner__line planner__line--now",style:w({top:`${r.value.styleTop}`}),ref_key:"timeLineEl",ref:e},[t("div",ne,u(r.value.caption),1)],4)])]))]))}};export{se as default};
