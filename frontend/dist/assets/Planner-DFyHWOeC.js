import{e as w,f as h,g as S,h as O,r as A,o as n,i as L,w as G,c,b as e,t as g,j as D,n as x,k as V,l as P,m as Y,p as N,q as z,F as M,s as E,u as F,v as R,x as Z,y as J,z as K,_ as U,a as I,A as j,B as q,C as Q,D as ee}from"./index-CC1E9bEo.js";const te={key:0,class:"event-card__short-wrapper"},ne={class:"event-card__name"},ae={class:"event-card__time"},se={class:"event-card__name-wrapper"},re={key:1,class:"event-card__time"},le={__name:"EventCard",props:["card","gridHeight"],setup(a){const s=a,r=w(()=>(new Date(s.card.end)-new Date(s.card.start))/(1e3*60*60)),l=h(S(s.card.event.start.dateTime)),o=w(()=>O(s.card.start)*100/24),d=w(()=>Math.max(r.value,.25)*100/24),_=w(()=>`${l.value} - ${S(s.card.event.end.dateTime)}`),y=w(()=>new Date(s.card.event.end.dateTime)<new Date),p=w(()=>s.gridHeight?[10,s.gridHeight/96]:[0,0]),m=w(()=>s.card.overlapLevel?s.card.overlapLevel+1:1);return($,u)=>{const v=A("vue-draggable-resizable");return a.gridHeight?(n(),L(v,{key:0,class:x(["event-card",{"no-padding":r.value<=.25,"no-right-padding":r.value<=.5,past:y.value,overlap:a.card.overlapLevel}]),axis:"y",grid:p.value,handles:["tm","bm"],active:!0,style:V({top:`${o.value}%`,height:`calc(${d.value}% - 2px)`,backgroundColor:`${a.card.event.background_color}`,color:`${a.card.event.foreground_color}`,width:`calc(100% - ${m.value*.75}rem)`})},{default:G(()=>[r.value<.75?(n(),c("div",te,[e("span",ne,g(a.card.event.summary)+",Â ",1),e("span",ae,g(l.value),1)])):D("",!0),e("div",se,[r.value>=.75?(n(),c("span",{key:0,class:x(["event-card__name",{"one-string":r.value<=1}])},g(a.card.event.summary),3)):D("",!0)]),r.value>=.75?(n(),c("span",re,g(_.value),1)):D("",!0)]),_:1},8,["grid","style","class"])):D("",!0)}}},ce=[{time:"01:00",percent:100/24},{time:"02:00",percent:200/24},{time:"03:00",percent:300/24},{time:"04:00",percent:400/24},{time:"05:00",percent:500/24},{time:"06:00",percent:600/24},{time:"07:00",percent:700/24},{time:"08:00",percent:800/24},{time:"09:00",percent:900/24},{time:"10:00",percent:1e3/24},{time:"11:00",percent:1100/24},{time:"12:00",percent:1200/24},{time:"13:00",percent:1300/24},{time:"14:00",percent:1400/24},{time:"15:00",percent:1500/24},{time:"16:00",percent:1600/24},{time:"17:00",percent:1700/24},{time:"18:00",percent:1800/24},{time:"19:00",percent:1900/24},{time:"20:00",percent:2e3/24},{time:"21:00",percent:2100/24},{time:"22:00",percent:2200/24},{time:"23:00",percent:2300/24}],oe={class:"planner-date__weekday"},ie={class:"planner-date__day"},de={__name:"PlannerDate",props:["day"],setup(a){return(s,r)=>(n(),c("div",{class:x(["planner-date",{current:a.day.isToday}])},[e("span",oe,g(a.day.weekday),1),e("div",ie,[e("span",null,g(a.day.date),1)])],2))}},ue={class:"planner__grid-wrapper"},_e={class:"planner__days-header"},ve={class:"planner__line-time"},pe={class:"planner__line-time"},me={__name:"PlannerGrid",props:["events","currentDate","selectedEvent"],emits:["eventClick"],setup(a,{emit:s}){const r=a,l=s,o=k=>{const f=k.sort((t,i)=>new Date(t.start)-new Date(i.start));for(let t=1;t<f.length;t++){const i=f[t],T=new Date(i.start);for(let C=t-1;C>=0;C--){const b=f[C];if(T>new Date(b.start)&&T<new Date(b.end)){b.overlapLevel?i.overlapLevel=b.overlapLevel+1:i.overlapLevel=1;break}}}return f},d=w(()=>{const k=P(r.currentDate),f=[];for(let t=0;t<7;t++){const i=new Date(k);i.setDate(k.getDate()+t),f.push({weekday:i.toLocaleDateString("en-EN",{weekday:"short"}),date:i.getDate(),isToday:Y(i,new Date),day:i,cards:[]})}return r.events.forEach(t=>{const i=new Date(t.start.dateTime),T=new Date(t.end.dateTime);if(i.getDate()===T.getDate()){const C=f.find(W=>W.date===i.getDate());if(!C)return;const b={event:t,start:t.start.dateTime,end:t.end.dateTime};C.cards.push(b)}else{const C={event:t,start:t.start.dateTime,end:t.start.dateTime.replace(/T\d{2}:\d{2}:\d{2}/,"T23:59:00")},b=f.find(B=>B.date===i.getDate());b&&b.cards.push(C);const W={event:t,start:t.end.dateTime.replace(/T\d{2}:\d{2}:\d{2}/,"T00:00:00"),end:t.end.dateTime},X=f.find(B=>B.date===T.getDate());b&&X.cards.push(W)}}),f.forEach(t=>t.cards=o(t.cards)),f}),_=h(null),y=h(),p=h(null),m=h(null),$=h({caption:"",styleTop:""}),u=()=>{m.value.style.display="none";const k=document.querySelector(".planner-date.current");if(!k)return;const f=(k.getBoundingClientRect().left-p.value.getBoundingClientRect().left)/p.value.offsetWidth*100,t=k.offsetWidth*.9/p.value.offsetWidth*100;m.value.style.left=`${f}%`,m.value.style.width=`${t}%`,m.value.style.display="block"},v=()=>{const k=new Date;$.value.caption=S(k),$.value.styleTop=`${O(k)*100/24}%`},H=async()=>{v(),await z(),u(),p.value.scrollIntoView({block:"center"});const f=(60-new Date().getSeconds())*1e3;setTimeout(()=>{v(),setInterval(v,6e4)},f)};return N(async()=>{await z(),H(),y.value=_.value.offsetHeight}),(k,f)=>(n(),c("div",ue,[e("div",_e,[(n(!0),c(M,null,E(d.value,t=>(n(),L(de,{key:t.date,day:t},null,8,["day"]))),128))]),e("div",{class:"planner__grid",ref_key:"grid",ref:_},[(n(!0),c(M,null,E(d.value,t=>(n(),c("div",{class:"planner__day-column",key:t.date},[(n(!0),c(M,null,E(t.cards,(i,T)=>(n(),L(le,{key:T,card:i,gridHeight:y.value,onClick:C=>l("cardClick",i),class:x({selected:a.selectedEvent===i.event})},null,8,["card","gridHeight","onClick","class"]))),128))]))),128)),(n(!0),c(M,null,E(F(ce),(t,i)=>(n(),c("div",{class:"planner__line",key:i,style:V({top:`${t.percent}%`})},[e("div",ve,g(t.time),1)],4))),128)),e("div",{class:"planner__line planner__line--now",style:V({top:`${$.value.styleTop}`}),ref_key:"timeLineEl",ref:p},[e("div",pe,g($.value.caption),1),e("div",{class:"planner__line-today-line",ref_key:"todayLine",ref:m},null,512)],4)],512)]))}},he={class:"planner-header"},fe={class:"planner-header__date"},ye={class:"planner-header__buttons"},ge={__name:"PlannerHeader",props:R(["isSidebarOpened","currentMonth"],{modelValue:{},modelModifiers:{}}),emits:R(["prevWeek","nextWeek","updateEvents"],["update:modelValue"]),setup(a,{emit:s}){const r=s,l=Z(a,"modelValue");return(o,d)=>(n(),c("header",he,[e("span",fe,g(a.currentMonth),1),e("div",ye,[e("button",{class:"planner-header__date-button planner-header__date-button--prev icon-button",onClick:d[0]||(d[0]=_=>r("prevWeek"))}),e("button",{class:"planner-header__date-button planner-header__date-button--next icon-button",onClick:d[1]||(d[1]=_=>r("nextWeek"))})]),e("label",{class:x(["sidebar-hide icon-button",{rotated:!l.value}])},[J(e("input",{type:"checkbox",class:"visually-hidden","onUpdate:modelValue":d[2]||(d[2]=_=>l.value=_)},null,512),[[K,l.value]])],2)]))}},ke={},$e={class:"loading-container"},we=e("div",{class:"loading-progress"},null,-1),De=[we];function be(a,s){return n(),c("div",$e,De)}const Ce=U(ke,[["render",be]]),Te={},Le={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},xe=e("path",{d:"M20.7457 3.32854C20.3552 2.93801 19.722 2.93801 19.3315 3.32854L12.0371 10.6229L4.74275 3.32854C4.35223 2.93801 3.71906 2.93801 3.32854 3.32854C2.93801 3.71906 2.93801 4.35223 3.32854 4.74275L10.6229 12.0371L3.32856 19.3314C2.93803 19.722 2.93803 20.3551 3.32856 20.7457C3.71908 21.1362 4.35225 21.1362 4.74277 20.7457L12.0371 13.4513L19.3315 20.7457C19.722 21.1362 20.3552 21.1362 20.7457 20.7457C21.1362 20.3551 21.1362 19.722 20.7457 19.3315L13.4513 12.0371L20.7457 4.74275C21.1362 4.35223 21.1362 3.71906 20.7457 3.32854Z",fill:"currentColor"},null,-1),Me=[xe];function Ee(a,s){return n(),c("svg",Le,Me)}const Se=U(Te,[["render",Ee]]),He={class:"event-info-sidebar"},Ve={class:"event-info-sidebar__buttons-wrapper"},We={class:"event-info-sidebar__event-title"},Be={class:"event-characteristics"},Pe=e("span",{class:"event-characteristics__name"},"Duration",-1),ze={class:"event-characteristics__value"},Ie=e("span",{class:"event-characteristics__name"},"Dates",-1),Ne={class:"event-characteristics__value"},Re={key:0},Oe=e("span",{class:"event-characteristics__name"},"Calendar",-1),Fe={class:"event-characteristics__value"},Ue={__name:"EventInfoSidebar",props:["event"],emits:["close"],setup(a,{emit:s}){const r=a,l=s,o=w(()=>{const _=new Date(r.event.start.dateTime),p=new Date(r.event.end.dateTime)-_,m=Math.floor(p/(1e3*60*60)),$=Math.floor(p%(1e3*60*60)/(1e3*60));return`${m} hr${m>1?"s":""}${$>0?` ${$} min`:""}`}),d=w(()=>{const _=new Date(r.event.start.dateTime),y=new Date(r.event.end.dateTime);return`${_.getDate()}/${_.getMonth()} ${S(_)} - ${S(y)}`});return(_,y)=>(n(),c("div",He,[e("div",Ve,[e("button",{class:"event-info-sidebar__button icon-button",onClick:y[0]||(y[0]=p=>l("close"))},[I(Se)])]),e("span",We,g(a.event.summary),1),e("ul",Be,[e("li",null,[Pe,e("span",ze,g(o.value),1)]),e("li",null,[Ie,e("span",Ne,g(d.value),1)]),a.event.calendar?(n(),c("li",Re,[Oe,e("span",Fe,g(a.event.calendar),1)])):D("",!0)])]))}},je={class:"task"},qe=["for"],Xe=["id"],Ae={__name:"TaskItem",props:["task"],setup(a){return(s,r)=>(n(),c("div",je,[e("span",{class:"task__color",style:V({backgroundColor:a.task.color})},null,4),e("label",{class:"task__checkbox-label",for:s.title},[e("input",{class:"visually-hidden",id:s.title,type:"checkbox"},null,8,Xe)],8,qe),e("span",null,g(a.task.name),1)]))}},Ge={class:"right-sidebar"},Ye={class:"right-sidebar__tabs"},Ze=e("span",null,"Tasks",-1),Je=[Ze],Ke={class:"underline"},Qe={key:0,class:"tasks"},et={__name:"RightSidebar",setup(a){const s=h(),r=h();h(null);const l=h(null),o=h(null),d=h(j.value.tasks);return N(()=>{o.value=l.value}),q(o,()=>{s.value.style.transform=`translateX(${o.value.offsetLeft}px)`,r.value.style.transform=`translateX(${o.value.offsetLeft}px)`}),(_,y)=>(n(),c("div",Ge,[e("div",Ye,[e("button",{ref_key:"tasksButton",ref:l,class:"right-sidebar__tab",onClick:y[0]||(y[0]=p=>o.value=l.value)},Je,512),e("div",Ke,[e("div",{ref_key:"underlineRight",ref:s,class:"underline__closer underline__closer--right"},null,512),e("div",{ref_key:"underlineLeft",ref:r,class:"underline__closer underline__closer--left"},null,512)])]),o.value===l.value?(n(),c("div",Qe,[(n(!0),c(M,null,E(d.value,p=>(n(),L(Ae,{key:p.id,task:p},null,8,["task"]))),128))])):D("",!0)]))}},tt={class:"planner-wrapper"},nt={class:"planner"},at={key:0,class:"planner__loader-wrapper"},rt={__name:"Planner",setup(a){const s=h(!0),r=h(),l=h(),o=h(!0),d=async(u=new Date)=>{try{const v=await Q.get(u);r.value=v,l.value=u}catch(v){console.error("Ð¾ÑÐ¸Ð±ÐºÐ°",v)}finally{o.value=!1,await z()}},_=async()=>{if(o.value)return;o.value=!0;const u=l.value,v=P(new Date(u.setDate(u.getDate()+7)));d(v)},y=async()=>{if(o.value)return;o.value=!0;const u=l.value,v=P(new Date(u.setDate(u.getDate()-7)));d(v)};q(ee,u=>{u&&d(l.value)});const p=w(()=>{if(l.value){const u=l.value;return`${u.toLocaleString("default",{month:"long"})} ${u.getFullYear()}`}else return""});N(()=>{d()});const m=h(null),$=u=>{m.value=u};return(u,v)=>(n(),c("div",tt,[e("div",nt,[I(ge,{modelValue:s.value,"onUpdate:modelValue":v[0]||(v[0]=H=>s.value=H),currentMonth:p.value,onPrevWeek:y,onNextWeek:_},null,8,["modelValue","currentMonth"]),o.value?(n(),c("div",at,[I(Ce)])):D("",!0),o.value?D("",!0):(n(),L(me,{key:1,events:r.value,"current-date":l.value,selectedEvent:m.value,onEventClick:$},null,8,["events","current-date","selectedEvent"]))]),F(j)?(n(),c("div",{key:0,class:x(["planner__right-sidebar",{hidden:!s.value}])},[m.value?D("",!0):(n(),L(et,{key:0})),m.value?(n(),L(Ue,{key:1,event:m.value,onClose:v[1]||(v[1]=H=>m.value=null)},null,8,["event"])):D("",!0)],2)):D("",!0)]))}};export{rt as default};
