import{m as C,e as H,o as a,c as l,b as e,t as p,f as I,v as z,n as b,_ as F,g as d,h as w,i as V,j as k,k as f,l as T,u as M,p as W,q as S,s as R,F as y,x as $,y as x,a as E,z as U,A as X,B as L,C as j}from"./index-Dkt1bcPe.js";const q={class:"planner-header"},A={class:"planner-header__date"},Y={class:"planner-header__buttons"},G={__name:"PlannerHeader",props:C(["isSidebarOpened","currentMonth"],{modelValue:{},modelModifiers:{}}),emits:C(["prevWeek","nextWeek"],["update:modelValue"]),setup(r,{emit:s}){const t=s,o=H(r,"modelValue");return(i,n)=>(a(),l("header",q,[e("span",A,p(r.currentMonth),1),e("div",Y,[e("button",{class:"planner-header__date-button planner-header__date-button--prev icon-button",onClick:n[0]||(n[0]=_=>t("prevWeek"))}),e("button",{class:"planner-header__date-button planner-header__date-button--next icon-button",onClick:n[1]||(n[1]=_=>t("nextWeek"))})]),e("label",{class:b(["sidebar-hide icon-button",{rotated:!o.value}])},[I(e("input",{type:"checkbox",class:"visually-hidden","onUpdate:modelValue":n[2]||(n[2]=_=>o.value=_)},null,512),[[z,o.value]])],2)]))}},J={},K={class:"loading-container"},Q=e("div",{class:"loading-progress"},null,-1),Z=[Q];function ee(r,s){return a(),l("div",K,Z)}const te=F(J,[["render",ee]]),ne={key:0,class:"event-card__short-wrapper"},ae={class:"event-card__name"},se={class:"event-card__time"},le={class:"event-card__name-wrapper"},re={key:1,class:"event-card__time"},oe={__name:"EventCard",props:["event"],setup(r){const s=r,t=d(w(s.event.end.dateTime)-w(s.event.start.dateTime)),o=d(V(s.event.start.dateTime)),i=k(()=>w(s.event.start.dateTime)*100/24),n=k(()=>t.value*100/24),_=k(()=>`${o.value} - ${V(s.event.end.dateTime)}`),c=k(()=>new Date(s.event.end.dateTime)<new Date);return(m,h)=>(a(),l("div",{class:b(["event-card",{"no-padding":t.value<=.25,"no-right-padding":t.value<=.5,past:c.value}]),style:T({top:`${i.value}%`,height:`calc(${n.value}% - 2px)`,backgroundColor:`${r.event.background_color}`,color:`${r.event.foreground_color}`})},[t.value<=.5?(a(),l("div",ne,[e("span",ae,p(r.event.summary)+", ",1),e("span",se,p(o.value),1)])):f("",!0),e("div",le,[t.value>.5?(a(),l("span",{key:0,class:b(["event-card__name",{"one-string":t.value<=1}])},p(r.event.summary),3)):f("",!0)]),t.value>.5?(a(),l("span",re,p(_.value),1)):f("",!0)],6))}},ie={class:"planner-date__weekday"},ce={class:"planner-date__day"},ue={__name:"PlannerDate",props:["date"],setup(r){const s=r,[t,o,i]=s.date.split("-").map(Number),n=new Date(t,o-1,i),_=k(()=>n.toLocaleDateString("en-EN",{weekday:"short"})),c=k(()=>new Date().getDate()===n.getDate());return(m,h)=>(a(),l("div",{class:b(["planner-date",{current:c.value}])},[e("span",ie,p(_.value),1),e("div",ce,[e("span",null,p(M(i)),1)])],2))}},de={class:"task"},_e=["for"],ve=["id"],pe={__name:"TaskItem",props:["task"],setup(r){return(s,t)=>(a(),l("div",de,[e("span",{class:"task__color",style:T({backgroundColor:r.task.color})},null,4),e("label",{class:"task__checkbox-label",for:s.title},[e("input",{class:"visually-hidden",id:s.title,type:"checkbox"},null,8,ve)],8,_e),e("span",null,p(r.task.name),1)]))}},me={class:"right-sidebar__tabs"},he=e("span",null,"Habits",-1),ke=[he],fe=e("span",null,"Tasks",-1),ye=[fe],$e={class:"underline"},be={key:0,class:"tasks"},ge={__name:"RightSidebar",props:["isOpened"],setup(r){const s=d(),t=d(),o=d(null),i=d(null),n=d(null),_=d(W.value.tasks);return S(()=>{n.value=i.value}),R(n,()=>{s.value.style.transform=`translateX(${n.value.offsetLeft}px)`,t.value.style.transform=`translateX(${n.value.offsetLeft}px)`}),(c,m)=>(a(),l("div",{class:b(["right-sidebar",{hidden:!r.isOpened}])},[e("div",me,[e("button",{ref_key:"habitsButton",ref:o,class:"right-sidebar__tab",onClick:m[0]||(m[0]=h=>n.value=o.value)},ke,512),e("button",{ref_key:"tasksButton",ref:i,class:"right-sidebar__tab",onClick:m[1]||(m[1]=h=>n.value=i.value)},ye,512),e("div",$e,[e("div",{ref_key:"underlineRight",ref:s,class:"underline__closer underline__closer--right"},null,512),e("div",{ref_key:"underlineLeft",ref:t,class:"underline__closer underline__closer--left"},null,512)])]),n.value===i.value?(a(),l("div",be,[(a(!0),l(y,null,$(_.value,h=>(a(),x(pe,{key:h.id,task:h},null,8,["task"]))),128))])):f("",!0)],2))}},we={class:"planner-wrapper"},xe={class:"planner"},Te={key:0,class:"planner__loader-wrapper"},De={key:1,class:"planner__grid-wrapper"},Le={class:"planner__days-header"},Ve={class:"planner__grid"},Ce={class:"planner__line-time"},Ee={class:"planner__line-time"},We={__name:"Planner",setup(r){const s=d(!0),t=d(null),o=d(null),i=d({caption:"",styleTop:""}),n=()=>{const u=new Date;i.value.caption=V(u),i.value.styleTop=`${w(u)*100/24}%`},_=async()=>{n(),await L(),o.value.scrollIntoView({block:"center"});const g=(60-new Date().getSeconds())*1e3;setTimeout(()=>{n(),setInterval(n,6e4)},g)},c=d(!0),m=async()=>{try{t.value=await U()}catch(u){console.error("ошибка",u)}finally{c.value=!1,_()}},h=async()=>{if(c.value)return;c.value=!0;const u=await X(t.value.mon.date);t.value=u,c.value=!1,await L(),o.value.scrollIntoView({block:"center"})},B=async()=>{if(c.value)return;c.value=!0;const u=await j(t.value.mon.date);t.value=u,c.value=!1,await L(),o.value.scrollIntoView({block:"center"})},N=[{time:"01:00",percent:100/24},{time:"02:00",percent:200/24},{time:"03:00",percent:300/24},{time:"04:00",percent:400/24},{time:"05:00",percent:500/24},{time:"06:00",percent:600/24},{time:"07:00",percent:700/24},{time:"08:00",percent:800/24},{time:"09:00",percent:900/24},{time:"10:00",percent:1e3/24},{time:"11:00",percent:1100/24},{time:"12:00",percent:1200/24},{time:"13:00",percent:1300/24},{time:"14:00",percent:1400/24},{time:"15:00",percent:1500/24},{time:"16:00",percent:1600/24},{time:"17:00",percent:1700/24},{time:"18:00",percent:1800/24},{time:"19:00",percent:1900/24},{time:"20:00",percent:2e3/24},{time:"21:00",percent:2100/24},{time:"22:00",percent:2200/24},{time:"23:00",percent:2300/24}],O=k(()=>{if(t.value){const u=new Date(t.value.mon.date);return`${u.toLocaleString("default",{month:"long"})} ${u.getFullYear()}`}else return""});return S(()=>{m()}),(u,g)=>(a(),l("div",we,[e("div",xe,[E(G,{modelValue:s.value,"onUpdate:modelValue":g[0]||(g[0]=v=>s.value=v),currentMonth:O.value,onPrevWeek:B,onNextWeek:h},null,8,["modelValue","currentMonth"]),c.value?(a(),l("div",Te,[E(te)])):f("",!0),c.value?f("",!0):(a(),l("div",De,[e("div",Le,[(a(!0),l(y,null,$(t.value,v=>(a(),x(ue,{key:v.date,date:v.date},null,8,["date"]))),128))]),e("div",Ve,[(a(!0),l(y,null,$(t.value,v=>(a(),l("div",{class:"planner__day-column",key:v.date},[(a(!0),l(y,null,$(v.events,(D,P)=>(a(),x(oe,{key:P,event:D},null,8,["event"]))),128))]))),128)),(a(),l(y,null,$(N,(v,D)=>e("div",{class:"planner__line",key:D,style:T({top:`${v.percent}%`})},[e("div",Ce,p(v.time),1)],4)),64)),e("div",{class:"planner__line planner__line--now",style:T({top:`${i.value.styleTop}`}),ref_key:"timeLineEl",ref:o},[e("div",Ee,p(i.value.caption),1)],4)])]))]),M(W)?(a(),x(ge,{key:0,isOpened:s.value},null,8,["isOpened"])):f("",!0)]))}};export{We as default};
