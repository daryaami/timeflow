import{e as b,f as _,g as S,h as z,r as U,o as a,i as T,w as F,c,b as e,t as h,j as $,n as C,k as V,l as B,m as W,F as E,p as M,u as I,q as P,s as j,v as q,x as X,_ as N,a as H,y as R,z as O,A,B as G,C as x,D as Y}from"./index-BPIXmcfP.js";const Z={key:0,class:"event-card__short-wrapper"},J={class:"event-card__name"},K={class:"event-card__time"},Q={class:"event-card__name-wrapper"},ee={key:1,class:"event-card__time"},te={__name:"EventCard",props:["event","gridHeight"],setup(s){const r=s,n=b(()=>(new Date(r.event.end.dateTime)-new Date(r.event.start.dateTime))/(1e3*60*60)),o=_(S(r.event.start.dateTime)),p=_(),u=b(()=>z(r.event.start.dateTime)*100/24),d=b(()=>Math.max(n.value,.25)*100/24),v=b(()=>`${o.value} - ${S(r.event.end.dateTime)}`),y=b(()=>new Date(r.event.end.dateTime)<new Date),w=b(()=>r.gridHeight?[10,r.gridHeight/96]:[0,0]),f=b(()=>r.event.overlapLevel?r.event.overlapLevel+1:1);return(g,l)=>{const t=U("vue-draggable-resizable");return s.gridHeight?(a(),T(t,{key:0,class:C(["event-card",{"no-padding":n.value<=.25,"no-right-padding":n.value<=.5,past:y.value,overlap:s.event.overlapLevel}]),axis:"y",grid:w.value,handles:["tm","bm"],active:!0,style:V({top:`${u.value}%`,height:`calc(${d.value}% - 2px)`,backgroundColor:`${s.event.background_color}`,color:`${s.event.foreground_color}`,width:`calc(100% - ${f.value*.75}rem)`}),ref_key:"card",ref:p},{default:F(()=>[n.value<.75?(a(),c("div",Z,[e("span",J,h(s.event.summary)+", ",1),e("span",K,h(o.value),1)])):$("",!0),e("div",Q,[n.value>=.75?(a(),c("span",{key:0,class:C(["event-card__name",{"one-string":n.value<=1}])},h(s.event.summary),3)):$("",!0)]),n.value>=.75?(a(),c("span",ee,h(v.value),1)):$("",!0)]),_:1},8,["grid","style","class"])):$("",!0)}}},ne=[{time:"01:00",percent:100/24},{time:"02:00",percent:200/24},{time:"03:00",percent:300/24},{time:"04:00",percent:400/24},{time:"05:00",percent:500/24},{time:"06:00",percent:600/24},{time:"07:00",percent:700/24},{time:"08:00",percent:800/24},{time:"09:00",percent:900/24},{time:"10:00",percent:1e3/24},{time:"11:00",percent:1100/24},{time:"12:00",percent:1200/24},{time:"13:00",percent:1300/24},{time:"14:00",percent:1400/24},{time:"15:00",percent:1500/24},{time:"16:00",percent:1600/24},{time:"17:00",percent:1700/24},{time:"18:00",percent:1800/24},{time:"19:00",percent:1900/24},{time:"20:00",percent:2e3/24},{time:"21:00",percent:2100/24},{time:"22:00",percent:2200/24},{time:"23:00",percent:2300/24}],ae={class:"planner__line-time"},se={class:"planner__line-time"},re={__name:"PlannerGrid",props:["days","selectedEvent"],emits:["eventClick"],setup(s,{emit:r}){const n=r,o=_(null),p=_(),u=_(null),d=_(null),v=_({caption:"",styleTop:""}),y=()=>{d.value.style.display="none";const g=document.querySelector(".planner-date.current");if(!g)return;const l=(g.getBoundingClientRect().left-u.value.getBoundingClientRect().left)/u.value.offsetWidth*100,t=g.offsetWidth*.9/u.value.offsetWidth*100;d.value.style.left=`${l}%`,d.value.style.width=`${t}%`,d.value.style.display="block"},w=()=>{const g=new Date;v.value.caption=S(g),v.value.styleTop=`${z(g)*100/24}%`},f=async()=>{w(),await W(),y(),u.value.scrollIntoView({block:"center"});const l=(60-new Date().getSeconds())*1e3;setTimeout(()=>{w(),setInterval(w,6e4)},l)};return B(async()=>{await W(),f(),p.value=o.value.offsetHeight}),(g,l)=>(a(),c("div",{class:"planner__grid",ref_key:"grid",ref:o},[(a(!0),c(E,null,M(s.days,t=>(a(),c("div",{class:"planner__day-column",key:t.date},[(a(!0),c(E,null,M(t.events,(i,m)=>(a(),T(te,{key:m,event:i,gridHeight:p.value,onClick:k=>n("eventClick",i),class:C({selected:s.selectedEvent===i})},null,8,["event","gridHeight","onClick","class"]))),128))]))),128)),(a(!0),c(E,null,M(I(ne),(t,i)=>(a(),c("div",{class:"planner__line",key:i,style:V({top:`${t.percent}%`})},[e("div",ae,h(t.time),1)],4))),128)),e("div",{class:"planner__line planner__line--now",style:V({top:`${v.value.styleTop}`}),ref_key:"timeLineEl",ref:u},[e("div",se,h(v.value.caption),1),e("div",{class:"planner__line-today-line",ref_key:"todayLine",ref:d},null,512)],4)],512))}},le={class:"planner-header"},oe={class:"planner-header__date"},ie={class:"planner-header__buttons"},ce={__name:"PlannerHeader",props:P(["isSidebarOpened","currentMonth"],{modelValue:{},modelModifiers:{}}),emits:P(["prevWeek","nextWeek"],["update:modelValue"]),setup(s,{emit:r}){const n=r,o=j(s,"modelValue");return(p,u)=>(a(),c("header",le,[e("span",oe,h(s.currentMonth),1),e("div",ie,[e("button",{class:"planner-header__date-button planner-header__date-button--prev icon-button",onClick:u[0]||(u[0]=d=>n("prevWeek"))}),e("button",{class:"planner-header__date-button planner-header__date-button--next icon-button",onClick:u[1]||(u[1]=d=>n("nextWeek"))})]),e("label",{class:C(["sidebar-hide icon-button",{rotated:!o.value}])},[q(e("input",{type:"checkbox",class:"visually-hidden","onUpdate:modelValue":u[2]||(u[2]=d=>o.value=d)},null,512),[[X,o.value]])],2)]))}},de={},ue={class:"loading-container"},ve=e("div",{class:"loading-progress"},null,-1),_e=[ve];function pe(s,r){return a(),c("div",ue,_e)}const me=N(de,[["render",pe]]),he={},ye={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},fe=e("path",{d:"M20.7457 3.32854C20.3552 2.93801 19.722 2.93801 19.3315 3.32854L12.0371 10.6229L4.74275 3.32854C4.35223 2.93801 3.71906 2.93801 3.32854 3.32854C2.93801 3.71906 2.93801 4.35223 3.32854 4.74275L10.6229 12.0371L3.32856 19.3314C2.93803 19.722 2.93803 20.3551 3.32856 20.7457C3.71908 21.1362 4.35225 21.1362 4.74277 20.7457L12.0371 13.4513L19.3315 20.7457C19.722 21.1362 20.3552 21.1362 20.7457 20.7457C21.1362 20.3551 21.1362 19.722 20.7457 19.3315L13.4513 12.0371L20.7457 4.74275C21.1362 4.35223 21.1362 3.71906 20.7457 3.32854Z",fill:"currentColor"},null,-1),ge=[fe];function ke(s,r){return a(),c("svg",ye,ge)}const $e=N(he,[["render",ke]]),we={class:"event-info-sidebar"},be={class:"event-info-sidebar__buttons-wrapper"},De={class:"event-info-sidebar__event-title"},Te={class:"event-characteristics"},Ce=e("span",{class:"event-characteristics__name"},"Duration",-1),Le={class:"event-characteristics__value"},xe=e("span",{class:"event-characteristics__name"},"Dates",-1),Ee={class:"event-characteristics__value"},Me={key:0},Se=e("span",{class:"event-characteristics__name"},"Calendar",-1),He={class:"event-characteristics__value"},Ve={__name:"EventInfoSidebar",props:["event"],emits:["close"],setup(s,{emit:r}){const n=s,o=r,p=b(()=>{const d=new Date(n.event.start.dateTime),y=new Date(n.event.end.dateTime)-d,w=Math.floor(y/(1e3*60*60)),f=Math.floor(y%(1e3*60*60)/(1e3*60));return`${w} hr${w>1?"s":""}${f>0?` ${f} min`:""}`}),u=b(()=>{const d=new Date(n.event.start.dateTime),v=new Date(n.event.end.dateTime);return`${d.getDate()}/${d.getMonth()} ${S(d)} - ${S(v)}`});return(d,v)=>(a(),c("div",we,[e("div",be,[e("button",{class:"event-info-sidebar__button icon-button",onClick:v[0]||(v[0]=y=>o("close"))},[H($e)])]),e("span",De,h(s.event.summary),1),e("ul",Te,[e("li",null,[Ce,e("span",Le,h(p.value),1)]),e("li",null,[xe,e("span",Ee,h(u.value),1)]),s.event.calendar?(a(),c("li",Me,[Se,e("span",He,h(s.event.calendar),1)])):$("",!0)])]))}},We={class:"planner-date__weekday"},Be={class:"planner-date__day"},Pe={__name:"PlannerDate",props:["day"],setup(s){return(r,n)=>(a(),c("div",{class:C(["planner-date",{current:s.day.isToday}])},[e("span",We,h(s.day.weekday),1),e("div",Be,[e("span",null,h(s.day.date),1)])],2))}},ze={class:"task"},Ie=["for"],Ne=["id"],Re={__name:"TaskItem",props:["task"],setup(s){return(r,n)=>(a(),c("div",ze,[e("span",{class:"task__color",style:V({backgroundColor:s.task.color})},null,4),e("label",{class:"task__checkbox-label",for:r.title},[e("input",{class:"visually-hidden",id:r.title,type:"checkbox"},null,8,Ne)],8,Ie),e("span",null,h(s.task.name),1)]))}},Oe={class:"right-sidebar"},Ue={class:"right-sidebar__tabs"},Fe=e("span",null,"Tasks",-1),je=[Fe],qe={class:"underline"},Xe={key:0,class:"tasks"},Ae={__name:"RightSidebar",setup(s){const r=_(),n=_();_(null);const o=_(null),p=_(null),u=_(R.value.tasks);return B(()=>{p.value=o.value}),O(p,()=>{r.value.style.transform=`translateX(${p.value.offsetLeft}px)`,n.value.style.transform=`translateX(${p.value.offsetLeft}px)`}),(d,v)=>(a(),c("div",Oe,[e("div",Ue,[e("button",{ref_key:"tasksButton",ref:o,class:"right-sidebar__tab",onClick:v[0]||(v[0]=y=>p.value=o.value)},je,512),e("div",qe,[e("div",{ref_key:"underlineRight",ref:r,class:"underline__closer underline__closer--right"},null,512),e("div",{ref_key:"underlineLeft",ref:n,class:"underline__closer underline__closer--left"},null,512)])]),p.value===o.value?(a(),c("div",Xe,[(a(!0),c(E,null,M(u.value,y=>(a(),T(Re,{key:y.id,task:y},null,8,["task"]))),128))])):$("",!0)]))}},Ge={class:"planner-wrapper"},Ye={class:"planner"},Ze={key:0,class:"planner__loader-wrapper"},Je={key:1,class:"planner__grid-wrapper"},Ke={class:"planner__days-header"},et={__name:"Planner",setup(s){const r=_(!0),n=_([]),o=_(!0),p=l=>{const t=l.sort((i,m)=>new Date(i.start.dateTime)-new Date(m.start.dateTime));for(let i=1;i<t.length;i++){const m=t[i],k=new Date(m.start.dateTime);for(let L=i-1;L>=0;L--){const D=t[L];if(k>new Date(D.start.dateTime)&&k<new Date(D.end.dateTime)){D.overlapLevel?m.overlapLevel=D.overlapLevel+1:m.overlapLevel=1;break}}}return t},u=(l,t)=>{const i=G(l);n.value=[];for(let m=0;m<7;m++){const k=new Date(i);k.setDate(i.getDate()+m);const L=t.filter(D=>x(k,new Date(D.start.dateTime))||x(k,new Date(D.end.dateTime)));n.value.push({weekday:k.toLocaleDateString("en-EN",{weekday:"short"}),date:k.getDate(),isToday:x(k,new Date),day:k,events:p(L)})}},d=async(l=new Date)=>{try{const t=await A(l);u(l,t)}catch(t){console.error("ошибка",t)}finally{o.value=!1,await W()}},v=async()=>{if(o.value)return;o.value=!0;const l=n.value[0].day,t=new Date(l.setDate(l.getDate()+7));d(t)},y=async()=>{if(o.value)return;o.value=!0;const l=n.value[0].day,t=new Date(l.setDate(l.getDate()-7));d(t)},w=b(()=>{if(n.value.length){const l=n.value[0].day;return`${l.toLocaleString("default",{month:"long"})} ${l.getFullYear()}`}else return""});B(()=>{d()}),O(Y,l=>{l.forEach(t=>{const i=n.value.find(m=>x(m.day,new Date(t.start.dateTime))||x(m.day,new Date(t.end.dateTime)));i&&i.events.push(t)})});const f=_(null),g=l=>{f.value=l};return(l,t)=>(a(),c("div",Ge,[e("div",Ye,[H(ce,{modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=i=>r.value=i),currentMonth:w.value,onPrevWeek:y,onNextWeek:v},null,8,["modelValue","currentMonth"]),o.value?(a(),c("div",Ze,[H(me)])):$("",!0),o.value?$("",!0):(a(),c("div",Je,[e("div",Ke,[(a(!0),c(E,null,M(n.value,i=>(a(),T(Pe,{key:i.date,day:i},null,8,["day"]))),128))]),H(re,{days:n.value,selectedEvent:f.value,onEventClick:g},null,8,["days","selectedEvent"])]))]),I(R)?(a(),c("div",{key:0,class:C(["planner__right-sidebar",{hidden:!r.value}])},[f.value?$("",!0):(a(),T(Ae,{key:0})),f.value?(a(),T(Ve,{key:1,event:f.value,onClose:t[1]||(t[1]=i=>f.value=null)},null,8,["event"])):$("",!0)],2)):$("",!0)]))}};export{et as default};
