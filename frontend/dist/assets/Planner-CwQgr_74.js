import{_ as T,o as s,c as r,b as n,n as L,e as g,t as _,f,g as u,h as D,a as b,i as k,F as m,j as v,k as B,l as E}from"./index-BVVeIwj1.js";const V={props:{isSidebarHidden:Boolean},emits:{"update:isSidebarHidden":Boolean}},C={class:"planner-header"},F={class:"planner-header__date"},M=n("span",null,"February 2024",-1),N=n("div",{class:"planner-header__date-buttons"},[n("button",{class:"planner-header__date-button planner-header__date-button--prev"}),n("button",{class:"planner-header__date-button planner-header__date-button--next"})],-1);function j(t,e,a,i,p,c){return s(),r("header",C,[n("div",F,[M,N,n("button",{class:L(["sidebar-hide",{rotated:a.isSidebarHidden}]),onClick:e[0]||(e[0]=d=>t.$emit("update:isSidebarHidden",!a.isSidebarHidden))},null,2)])])}const z=T(V,[["render",j]]),I={},P={class:"loading-container"},U=n("div",{class:"loading-progress"},null,-1),q=[U];function A(t,e){return s(),r("div",P,q)}const G=T(I,[["render",A]]),h=t=>{let e;typeof t=="string"?e=new Date(t):e=t;let a=e.getHours(),i=e.getMinutes();return a+i/60},y=t=>{let e;typeof t=="string"?e=new Date(t):e=t;const a=String(e.getHours()).padStart(2,"0"),i=String(e.getMinutes()).padStart(2,"0");return`${a}:${i}`},J={class:"event-card__name"},K={class:"event-card__time"},O={__name:"EventCard",props:["event"],setup(t){const e=t,a=g(()=>h(e.event.start.dateTime)*100/24),i=g(()=>(h(e.event.end.dateTime)-h(e.event.start.dateTime))*100/24),p=g(()=>`${y(e.event.start.dateTime)} - ${y(e.event.end.dateTime)}`);return(c,d)=>(s(),r("div",{class:"event-card",style:f({top:`${a.value}%`,height:`${i.value}%`})},[n("span",J,_(t.event.summary),1),n("span",K,_(p.value),1)],4))}},Q=async()=>{let t=await fetch(`${window.location.origin}/planner_api/get_events/`);if(t.ok)return(await t.json()).days;throw new Error("Failed to fetch events")},R={class:"planner"},W={key:0,class:"planner__loader-wrapper"},X={key:1,class:"planner__grid-wrapper"},Y={class:"planner__days-header"},Z={class:"planner__grid"},ee={class:"planner__line-time"},te={class:"planner__line-time"},ae={__name:"Planner",setup(t){const e=u(null),a=u({caption:"",styleTop:""}),i=()=>{const l=new Date;a.value.caption=y(l),a.value.styleTop=`${h(l)*100/24}%`},p=async()=>{i(),await E(),e.value.scrollIntoView({block:"center"});const w=(60-new Date().getSeconds())*1e3;setTimeout(()=>{i(),setInterval(i,6e4)},w)},c=u([]),d=u(!0),S=async()=>{try{c.value=await Q()}catch(l){console.error("ошибка",l)}finally{d.value=!1,p()}};D(()=>{S()});const H=[{time:"01:00",percent:100/24},{time:"02:00",percent:200/24},{time:"03:00",percent:300/24},{time:"04:00",percent:400/24},{time:"05:00",percent:500/24},{time:"06:00",percent:600/24},{time:"07:00",percent:700/24},{time:"08:00",percent:800/24},{time:"09:00",percent:900/24},{time:"10:00",percent:1e3/24},{time:"11:00",percent:1100/24},{time:"12:00",percent:1200/24},{time:"13:00",percent:1300/24},{time:"14:00",percent:1400/24},{time:"15:00",percent:1500/24},{time:"16:00",percent:1600/24},{time:"17:00",percent:1700/24},{time:"18:00",percent:1800/24},{time:"19:00",percent:1900/24},{time:"20:00",percent:2e3/24},{time:"21:00",percent:2100/24},{time:"22:00",percent:2200/24},{time:"23:00",percent:2300/24}];return(l,w)=>(s(),r("div",R,[b(z),d.value?(s(),r("div",W,[b(G)])):k("",!0),d.value?k("",!0):(s(),r("div",X,[n("div",Y,[(s(!0),r(m,null,v(c.value,o=>(s(),r("span",{class:"planner__date",key:o.date},_(o.date),1))),128))]),n("div",Z,[(s(!0),r(m,null,v(c.value,o=>(s(),r("div",{class:"planner__day-column",key:o.date},[(s(!0),r(m,null,v(o.events,($,x)=>(s(),B(O,{key:x,event:$},null,8,["event"]))),128))]))),128)),(s(),r(m,null,v(H,(o,$)=>n("div",{class:"planner__line",key:$,style:f({top:`${o.percent}%`})},[n("div",ee,_(o.time),1)],4)),64)),n("div",{class:"planner__line planner__line--now",style:f({top:`${a.value.styleTop}`}),ref_key:"timeLineEl",ref:e},[n("div",te,_(a.value.caption),1)],4)])]))]))}};export{ae as default};
