import{e as _,g as x,f as M,h as k,r as O,o as l,i as w,w as P,c as o,b as e,t as h,j as g,n as D,k as T,l as S,m as H,F as $,p as b,u as B,q as W,s as z,v as N,x as R,_ as F,y as E,z as I,a as C,A as U,B as q,C as L}from"./index-CFfHTM7t.js";const X={key:0,class:"event-card__short-wrapper"},j={class:"event-card__name"},A={class:"event-card__time"},G={class:"event-card__name-wrapper"},Y={key:1,class:"event-card__time"},J={__name:"EventCard",props:["event","gridHeight"],setup(r){const n=r,t=_(x(n.event.end.dateTime)-x(n.event.start.dateTime)),a=_(M(n.event.start.dateTime)),d=k(()=>x(n.event.start.dateTime)*100/24),i=k(()=>Math.max(t.value,.25)*100/24),p=k(()=>`${a.value} - ${M(n.event.end.dateTime)}`),m=k(()=>new Date(n.event.end.dateTime)<new Date),y=k(()=>n.gridHeight?[10,n.gridHeight/96]:[0,0]);return(s,c)=>{const u=O("vue-draggable-resizable");return r.gridHeight?(l(),w(u,{key:0,class:D(["event-card",{"no-padding":t.value<=.25,"no-right-padding":t.value<=.5,past:m.value}]),axis:"y",grid:y.value,handles:["tm","bm"],active:!0,style:T({top:`${d.value}%`,height:`calc(${i.value}% - 2px)`,backgroundColor:`${r.event.background_color}`,color:`${r.event.foreground_color}`})},{default:P(()=>[t.value<=.5?(l(),o("div",X,[e("span",j,h(r.event.summary)+", ",1),e("span",A,h(a.value),1)])):g("",!0),e("div",G,[t.value>.5?(l(),o("span",{key:0,class:D(["event-card__name",{"one-string":t.value<=1}])},h(r.event.summary),3)):g("",!0)]),t.value>.5?(l(),o("span",Y,h(p.value),1)):g("",!0)]),_:1},8,["grid","style","class"])):g("",!0)}}},K=[{time:"01:00",percent:100/24},{time:"02:00",percent:200/24},{time:"03:00",percent:300/24},{time:"04:00",percent:400/24},{time:"05:00",percent:500/24},{time:"06:00",percent:600/24},{time:"07:00",percent:700/24},{time:"08:00",percent:800/24},{time:"09:00",percent:900/24},{time:"10:00",percent:1e3/24},{time:"11:00",percent:1100/24},{time:"12:00",percent:1200/24},{time:"13:00",percent:1300/24},{time:"14:00",percent:1400/24},{time:"15:00",percent:1500/24},{time:"16:00",percent:1600/24},{time:"17:00",percent:1700/24},{time:"18:00",percent:1800/24},{time:"19:00",percent:1900/24},{time:"20:00",percent:2e3/24},{time:"21:00",percent:2100/24},{time:"22:00",percent:2200/24},{time:"23:00",percent:2300/24}],Q={class:"planner__line-time"},Z={class:"planner__line-time"},ee={__name:"PlannerGrid",props:["days"],setup(r){const n=_(null),t=_(),a=_(null),d=_(null),i=_({caption:"",styleTop:""}),p=()=>{d.value.style.display="none";const s=document.querySelector(".planner-date.current");if(!s)return;const c=(s.getBoundingClientRect().left-a.value.getBoundingClientRect().left)/a.value.offsetWidth*100,u=s.offsetWidth*.9/a.value.offsetWidth*100;d.value.style.left=`${c}%`,d.value.style.width=`${u}%`,d.value.style.display="block"},m=()=>{const s=new Date;i.value.caption=M(s),i.value.styleTop=`${x(s)*100/24}%`},y=async()=>{m(),await H(),p(),a.value.scrollIntoView({block:"center"});const c=(60-new Date().getSeconds())*1e3;setTimeout(()=>{m(),setInterval(m,6e4)},c)};return S(async()=>{await H(),y(),t.value=n.value.offsetHeight}),(s,c)=>(l(),o("div",{class:"planner__grid",ref_key:"grid",ref:n},[(l(!0),o($,null,b(r.days,u=>(l(),o("div",{class:"planner__day-column",key:u.date},[(l(!0),o($,null,b(u.events,(v,f)=>(l(),w(J,{key:f,event:v,gridHeight:t.value},null,8,["event","gridHeight"]))),128))]))),128)),(l(!0),o($,null,b(B(K),(u,v)=>(l(),o("div",{class:"planner__line",key:v,style:T({top:`${u.percent}%`})},[e("div",Q,h(u.time),1)],4))),128)),e("div",{class:"planner__line planner__line--now",style:T({top:`${i.value.styleTop}`}),ref_key:"timeLineEl",ref:a},[e("div",Z,h(i.value.caption),1),e("div",{class:"planner__line-today-line",ref_key:"todayLine",ref:d},null,512)],4)],512))}},te={class:"planner-header"},ne={class:"planner-header__date"},ae={class:"planner-header__buttons"},se={__name:"PlannerHeader",props:W(["isSidebarOpened","currentMonth"],{modelValue:{},modelModifiers:{}}),emits:W(["prevWeek","nextWeek"],["update:modelValue"]),setup(r,{emit:n}){const t=n,a=z(r,"modelValue");return(d,i)=>(l(),o("header",te,[e("span",ne,h(r.currentMonth),1),e("div",ae,[e("button",{class:"planner-header__date-button planner-header__date-button--prev icon-button",onClick:i[0]||(i[0]=p=>t("prevWeek"))}),e("button",{class:"planner-header__date-button planner-header__date-button--next icon-button",onClick:i[1]||(i[1]=p=>t("nextWeek"))})]),e("label",{class:D(["sidebar-hide icon-button",{rotated:!a.value}])},[N(e("input",{type:"checkbox",class:"visually-hidden","onUpdate:modelValue":i[2]||(i[2]=p=>a.value=p)},null,512),[[R,a.value]])],2)]))}},le={},re={class:"loading-container"},oe=e("div",{class:"loading-progress"},null,-1),ie=[oe];function ce(r,n){return l(),o("div",re,ie)}const de=F(le,[["render",ce]]),ue={class:"planner-date__weekday"},_e={class:"planner-date__day"},ve={__name:"PlannerDate",props:["day"],setup(r){return(n,t)=>(l(),o("div",{class:D(["planner-date",{current:r.day.isToday}])},[e("span",ue,h(r.day.weekday),1),e("div",_e,[e("span",null,h(r.day.date),1)])],2))}},pe={class:"task"},me=["for"],he=["id"],ye={__name:"TaskItem",props:["task"],setup(r){return(n,t)=>(l(),o("div",pe,[e("span",{class:"task__color",style:T({backgroundColor:r.task.color})},null,4),e("label",{class:"task__checkbox-label",for:n.title},[e("input",{class:"visually-hidden",id:n.title,type:"checkbox"},null,8,he)],8,me),e("span",null,h(r.task.name),1)]))}},fe={class:"right-sidebar__tabs"},ge=e("span",null,"Tasks",-1),ke=[ge],$e={class:"underline"},be={key:0,class:"tasks"},we={__name:"RightSidebar",props:["isOpened"],setup(r){const n=_(),t=_();_(null);const a=_(null),d=_(null),i=_(E.value.tasks);return S(()=>{d.value=a.value}),I(d,()=>{n.value.style.transform=`translateX(${d.value.offsetLeft}px)`,t.value.style.transform=`translateX(${d.value.offsetLeft}px)`}),(p,m)=>(l(),o("div",{class:D(["right-sidebar",{hidden:!r.isOpened}])},[e("div",fe,[e("button",{ref_key:"tasksButton",ref:a,class:"right-sidebar__tab",onClick:m[0]||(m[0]=y=>d.value=a.value)},ke,512),e("div",$e,[e("div",{ref_key:"underlineRight",ref:n,class:"underline__closer underline__closer--right"},null,512),e("div",{ref_key:"underlineLeft",ref:t,class:"underline__closer underline__closer--left"},null,512)])]),d.value===a.value?(l(),o("div",be,[(l(!0),o($,null,b(i.value,y=>(l(),w(ye,{key:y.id,task:y},null,8,["task"]))),128))])):g("",!0)],2))}},De={class:"planner-wrapper"},xe={class:"planner"},Te={key:0,class:"planner__loader-wrapper"},Ce={key:1,class:"planner__grid-wrapper"},Le={class:"planner__days-header"},He={__name:"Planner",setup(r){const n=_(!0),t=_([]),a=_(!0),d=(s,c)=>{const u=q(s);t.value=[];for(let v=0;v<7;v++){const f=new Date(u);f.setDate(u.getDate()+v),t.value.push({weekday:f.toLocaleDateString("en-EN",{weekday:"short"}),date:f.getDate(),isToday:L(f,new Date),day:f,events:[]})}t.value.forEach(v=>{const f=c.filter(V=>L(v.day,new Date(V.start.dateTime))||L(v.day,new Date(V.end.dateTime)));v.events=f})},i=async(s=new Date)=>{try{const c=await U(s);d(s,c)}catch(c){console.error("ошибка",c)}finally{a.value=!1,await H()}},p=async()=>{if(a.value)return;a.value=!0;const s=t.value[0].day,c=new Date(s.setDate(s.getDate()+7));i(c)},m=async()=>{if(a.value)return;a.value=!0;const s=t.value[0].day,c=new Date(s.setDate(s.getDate()-7));i(c)},y=k(()=>{if(t.value.length){const s=t.value[0].day;return`${s.toLocaleString("default",{month:"long"})} ${s.getFullYear()}`}else return""});return S(()=>{i()}),(s,c)=>(l(),o("div",De,[e("div",xe,[C(se,{modelValue:n.value,"onUpdate:modelValue":c[0]||(c[0]=u=>n.value=u),currentMonth:y.value,onPrevWeek:m,onNextWeek:p},null,8,["modelValue","currentMonth"]),a.value?(l(),o("div",Te,[C(de)])):g("",!0),a.value?g("",!0):(l(),o("div",Ce,[e("div",Le,[(l(!0),o($,null,b(t.value,u=>(l(),w(ve,{key:u.date,day:u},null,8,["day"]))),128))]),C(ee,{days:t.value},null,8,["days"])]))]),B(E)?(l(),w(we,{key:0,isOpened:n.value},null,8,["isOpened"])):g("",!0)]))}};export{He as default};
