import{e as _,g as T,f as M,h as k,r as P,o as r,i as D,w as z,c,b as t,t as h,j as g,n as x,k as C,l as S,m as H,F as b,p as w,u as E,q as W,s as N,v as R,x as F,_ as I,y as B,z as O,a as L,A as U,B as q,C as $,D as A}from"./index-DWSzIuNK.js";const X={key:0,class:"event-card__short-wrapper"},j={class:"event-card__name"},G={class:"event-card__time"},Y={class:"event-card__name-wrapper"},J={key:1,class:"event-card__time"},K={__name:"EventCard",props:["event","gridHeight"],setup(l){const a=l,e=_(T(a.event.end.dateTime)-T(a.event.start.dateTime)),s=_(M(a.event.start.dateTime)),u=k(()=>T(a.event.start.dateTime)*100/24),d=k(()=>Math.max(e.value,.25)*100/24),p=k(()=>`${s.value} - ${M(a.event.end.dateTime)}`),m=k(()=>new Date(a.event.end.dateTime)<new Date),y=k(()=>a.gridHeight?[10,a.gridHeight/96]:[0,0]);return(n,o)=>{const i=P("vue-draggable-resizable");return l.gridHeight?(r(),D(i,{key:0,class:x(["event-card",{"no-padding":e.value<=.25,"no-right-padding":e.value<=.5,past:m.value}]),axis:"y",grid:y.value,handles:["tm","bm"],active:!0,style:C({top:`${u.value}%`,height:`calc(${d.value}% - 2px)`,backgroundColor:`${l.event.background_color}`,color:`${l.event.foreground_color}`})},{default:z(()=>[e.value<=.5?(r(),c("div",X,[t("span",j,h(l.event.summary)+", ",1),t("span",G,h(s.value),1)])):g("",!0),t("div",Y,[e.value>.5?(r(),c("span",{key:0,class:x(["event-card__name",{"one-string":e.value<=1}])},h(l.event.summary),3)):g("",!0)]),e.value>.5?(r(),c("span",J,h(p.value),1)):g("",!0)]),_:1},8,["grid","style","class"])):g("",!0)}}},Q=[{time:"01:00",percent:100/24},{time:"02:00",percent:200/24},{time:"03:00",percent:300/24},{time:"04:00",percent:400/24},{time:"05:00",percent:500/24},{time:"06:00",percent:600/24},{time:"07:00",percent:700/24},{time:"08:00",percent:800/24},{time:"09:00",percent:900/24},{time:"10:00",percent:1e3/24},{time:"11:00",percent:1100/24},{time:"12:00",percent:1200/24},{time:"13:00",percent:1300/24},{time:"14:00",percent:1400/24},{time:"15:00",percent:1500/24},{time:"16:00",percent:1600/24},{time:"17:00",percent:1700/24},{time:"18:00",percent:1800/24},{time:"19:00",percent:1900/24},{time:"20:00",percent:2e3/24},{time:"21:00",percent:2100/24},{time:"22:00",percent:2200/24},{time:"23:00",percent:2300/24}],Z={class:"planner__line-time"},ee={class:"planner__line-time"},te={__name:"PlannerGrid",props:["days"],setup(l){const a=_(null),e=_(),s=_(null),u=_(null),d=_({caption:"",styleTop:""}),p=()=>{u.value.style.display="none";const n=document.querySelector(".planner-date.current");if(!n)return;const o=(n.getBoundingClientRect().left-s.value.getBoundingClientRect().left)/s.value.offsetWidth*100,i=n.offsetWidth*.9/s.value.offsetWidth*100;u.value.style.left=`${o}%`,u.value.style.width=`${i}%`,u.value.style.display="block"},m=()=>{const n=new Date;d.value.caption=M(n),d.value.styleTop=`${T(n)*100/24}%`},y=async()=>{m(),await H(),p(),s.value.scrollIntoView({block:"center"});const o=(60-new Date().getSeconds())*1e3;setTimeout(()=>{m(),setInterval(m,6e4)},o)};return S(async()=>{await H(),y(),e.value=a.value.offsetHeight}),(n,o)=>(r(),c("div",{class:"planner__grid",ref_key:"grid",ref:a},[(r(!0),c(b,null,w(l.days,i=>(r(),c("div",{class:"planner__day-column",key:i.date},[(r(!0),c(b,null,w(i.events,(v,f)=>(r(),D(K,{key:f,event:v,gridHeight:e.value},null,8,["event","gridHeight"]))),128))]))),128)),(r(!0),c(b,null,w(E(Q),(i,v)=>(r(),c("div",{class:"planner__line",key:v,style:C({top:`${i.percent}%`})},[t("div",Z,h(i.time),1)],4))),128)),t("div",{class:"planner__line planner__line--now",style:C({top:`${d.value.styleTop}`}),ref_key:"timeLineEl",ref:s},[t("div",ee,h(d.value.caption),1),t("div",{class:"planner__line-today-line",ref_key:"todayLine",ref:u},null,512)],4)],512))}},ne={class:"planner-header"},ae={class:"planner-header__date"},se={class:"planner-header__buttons"},re={__name:"PlannerHeader",props:W(["isSidebarOpened","currentMonth"],{modelValue:{},modelModifiers:{}}),emits:W(["prevWeek","nextWeek"],["update:modelValue"]),setup(l,{emit:a}){const e=a,s=N(l,"modelValue");return(u,d)=>(r(),c("header",ne,[t("span",ae,h(l.currentMonth),1),t("div",se,[t("button",{class:"planner-header__date-button planner-header__date-button--prev icon-button",onClick:d[0]||(d[0]=p=>e("prevWeek"))}),t("button",{class:"planner-header__date-button planner-header__date-button--next icon-button",onClick:d[1]||(d[1]=p=>e("nextWeek"))})]),t("label",{class:x(["sidebar-hide icon-button",{rotated:!s.value}])},[R(t("input",{type:"checkbox",class:"visually-hidden","onUpdate:modelValue":d[2]||(d[2]=p=>s.value=p)},null,512),[[F,s.value]])],2)]))}},le={},oe={class:"loading-container"},ie=t("div",{class:"loading-progress"},null,-1),ce=[ie];function de(l,a){return r(),c("div",oe,ce)}const ue=I(le,[["render",de]]),_e={class:"planner-date__weekday"},ve={class:"planner-date__day"},pe={__name:"PlannerDate",props:["day"],setup(l){return(a,e)=>(r(),c("div",{class:x(["planner-date",{current:l.day.isToday}])},[t("span",_e,h(l.day.weekday),1),t("div",ve,[t("span",null,h(l.day.date),1)])],2))}},me={class:"task"},he=["for"],ye=["id"],fe={__name:"TaskItem",props:["task"],setup(l){return(a,e)=>(r(),c("div",me,[t("span",{class:"task__color",style:C({backgroundColor:l.task.color})},null,4),t("label",{class:"task__checkbox-label",for:a.title},[t("input",{class:"visually-hidden",id:a.title,type:"checkbox"},null,8,ye)],8,he),t("span",null,h(l.task.name),1)]))}},ge={class:"right-sidebar__tabs"},ke=t("span",null,"Tasks",-1),$e=[ke],be={class:"underline"},we={key:0,class:"tasks"},De={__name:"RightSidebar",props:["isOpened"],setup(l){const a=_(),e=_();_(null);const s=_(null),u=_(null),d=_(B.value.tasks);return S(()=>{u.value=s.value}),O(u,()=>{a.value.style.transform=`translateX(${u.value.offsetLeft}px)`,e.value.style.transform=`translateX(${u.value.offsetLeft}px)`}),(p,m)=>(r(),c("div",{class:x(["right-sidebar",{hidden:!l.isOpened}])},[t("div",ge,[t("button",{ref_key:"tasksButton",ref:s,class:"right-sidebar__tab",onClick:m[0]||(m[0]=y=>u.value=s.value)},$e,512),t("div",be,[t("div",{ref_key:"underlineRight",ref:a,class:"underline__closer underline__closer--right"},null,512),t("div",{ref_key:"underlineLeft",ref:e,class:"underline__closer underline__closer--left"},null,512)])]),u.value===s.value?(r(),c("div",we,[(r(!0),c(b,null,w(d.value,y=>(r(),D(fe,{key:y.id,task:y},null,8,["task"]))),128))])):g("",!0)],2))}},xe={class:"planner-wrapper"},Te={class:"planner"},Ce={key:0,class:"planner__loader-wrapper"},Le={key:1,class:"planner__grid-wrapper"},Me={class:"planner__days-header"},Se={__name:"Planner",setup(l){const a=_(!0),e=_([]),s=_(!0),u=(n,o)=>{const i=q(n);e.value=[];for(let v=0;v<7;v++){const f=new Date(i);f.setDate(i.getDate()+v),e.value.push({weekday:f.toLocaleDateString("en-EN",{weekday:"short"}),date:f.getDate(),isToday:$(f,new Date),day:f,events:[]})}e.value.forEach(v=>{const f=o.filter(V=>$(v.day,new Date(V.start.dateTime))||$(v.day,new Date(V.end.dateTime)));v.events=f})},d=async(n=new Date)=>{try{const o=await U(n);u(n,o)}catch(o){console.error("ошибка",o)}finally{s.value=!1,await H()}},p=async()=>{if(s.value)return;s.value=!0;const n=e.value[0].day,o=new Date(n.setDate(n.getDate()+7));d(o)},m=async()=>{if(s.value)return;s.value=!0;const n=e.value[0].day,o=new Date(n.setDate(n.getDate()-7));d(o)},y=k(()=>{if(e.value.length){const n=e.value[0].day;return`${n.toLocaleString("default",{month:"long"})} ${n.getFullYear()}`}else return""});return S(()=>{d()}),O(A,n=>{n.forEach(o=>{const i=e.value.filter(v=>$(v.day,new Date(o.start.dateTime))||$(v.day,new Date(o.end.dateTime)));if(i.length)i[0].events.push(o);else return}),e.value=e.value}),(n,o)=>(r(),c("div",xe,[t("div",Te,[L(re,{modelValue:a.value,"onUpdate:modelValue":o[0]||(o[0]=i=>a.value=i),currentMonth:y.value,onPrevWeek:m,onNextWeek:p},null,8,["modelValue","currentMonth"]),s.value?(r(),c("div",Ce,[L(ue)])):g("",!0),s.value?g("",!0):(r(),c("div",Le,[t("div",Me,[(r(!0),c(b,null,w(e.value,i=>(r(),D(pe,{key:i.date,day:i},null,8,["day"]))),128))]),L(te,{days:e.value},null,8,["days"])]))]),E(B)?(r(),D(De,{key:0,isOpened:a.value},null,8,["isOpened"])):g("",!0)]))}};export{Se as default};
