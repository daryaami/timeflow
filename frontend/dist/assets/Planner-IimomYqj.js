import{e as u,g as x,f as D,h,r as S,o as r,i as b,w as N,c as i,b as e,t as m,j as f,n as w,k as T,l as E,m as L,F as y,p as $,q as V,s as O,v as P,x as z,_ as I,u as H,y as M,z as R,a as C,A as F,B as U,C as q}from"./index-DfcarvWo.js";const X={key:0,class:"event-card__short-wrapper"},j={class:"event-card__name"},A={class:"event-card__time"},G={class:"event-card__name-wrapper"},Y={key:1,class:"event-card__time"},J={__name:"EventCard",props:["event","gridHeight"],setup(l){const a=l,t=u(x(a.event.end.dateTime)-x(a.event.start.dateTime)),n=u(D(a.event.start.dateTime)),c=h(()=>x(a.event.start.dateTime)*100/24),s=h(()=>Math.max(t.value,.25)*100/24),_=h(()=>`${n.value} - ${D(a.event.end.dateTime)}`),p=h(()=>new Date(a.event.end.dateTime)<new Date),o=h(()=>a.gridHeight?[10,a.gridHeight/96]:[0,0]);return(v,d)=>{const g=S("vue-draggable-resizable");return l.gridHeight?(r(),b(g,{key:0,class:w(["event-card",{"no-padding":t.value<=.25,"no-right-padding":t.value<=.5,past:p.value}]),axis:"y",grid:o.value,handles:["tm","bm"],active:!0,style:T({top:`${c.value}%`,height:`calc(${s.value}% - 2px)`,backgroundColor:`${l.event.background_color}`,color:`${l.event.foreground_color}`})},{default:N(()=>[t.value<=.5?(r(),i("div",X,[e("span",j,m(l.event.summary)+", ",1),e("span",A,m(n.value),1)])):f("",!0),e("div",G,[t.value>.5?(r(),i("span",{key:0,class:w(["event-card__name",{"one-string":t.value<=1}])},m(l.event.summary),3)):f("",!0)]),t.value>.5?(r(),i("span",Y,m(_.value),1)):f("",!0)]),_:1},8,["grid","style","class"])):f("",!0)}}},K={class:"planner__line-time"},Q={class:"planner__line-time"},Z={__name:"PlannerGrid",props:["currentWeekEvents"],setup(l){const a=u(null),t=u(),n=u(null),c=u(null),s=u({caption:"",styleTop:""}),_=()=>{const d=document.querySelector(".planner-date.current");if(!d)return;const g=(d.getBoundingClientRect().left-n.value.getBoundingClientRect().left)/n.value.offsetWidth*100,k=d.offsetWidth*.9/n.value.offsetWidth*100;c.value.style.left=`${g}%`,c.value.style.width=`${k}%`},p=()=>{const d=new Date;s.value.caption=D(d),s.value.styleTop=`${x(d)*100/24}%`},o=async()=>{p(),await L(),_(),n.value.scrollIntoView({block:"center"});const g=(60-new Date().getSeconds())*1e3;setTimeout(()=>{p(),setInterval(p,6e4)},g)},v=[{time:"01:00",percent:100/24},{time:"02:00",percent:200/24},{time:"03:00",percent:300/24},{time:"04:00",percent:400/24},{time:"05:00",percent:500/24},{time:"06:00",percent:600/24},{time:"07:00",percent:700/24},{time:"08:00",percent:800/24},{time:"09:00",percent:900/24},{time:"10:00",percent:1e3/24},{time:"11:00",percent:1100/24},{time:"12:00",percent:1200/24},{time:"13:00",percent:1300/24},{time:"14:00",percent:1400/24},{time:"15:00",percent:1500/24},{time:"16:00",percent:1600/24},{time:"17:00",percent:1700/24},{time:"18:00",percent:1800/24},{time:"19:00",percent:1900/24},{time:"20:00",percent:2e3/24},{time:"21:00",percent:2100/24},{time:"22:00",percent:2200/24},{time:"23:00",percent:2300/24}];return E(async()=>{await L(),o(),t.value=a.value.offsetHeight}),(d,g)=>(r(),i("div",{class:"planner__grid",ref_key:"grid",ref:a},[(r(!0),i(y,null,$(l.currentWeekEvents,k=>(r(),i("div",{class:"planner__day-column",key:k.date},[(r(!0),i(y,null,$(k.events,(W,B)=>(r(),b(J,{key:B,event:W,gridHeight:t.value},null,8,["event","gridHeight"]))),128))]))),128)),(r(),i(y,null,$(v,(k,W)=>e("div",{class:"planner__line",key:W,style:T({top:`${k.percent}%`})},[e("div",K,m(k.time),1)],4)),64)),e("div",{class:"planner__line planner__line--now",style:T({top:`${s.value.styleTop}`}),ref_key:"timeLineEl",ref:n},[e("div",Q,m(s.value.caption),1),e("div",{class:"planner__line-today-line",ref_key:"todayLine",ref:c},null,512)],4)],512))}},ee={class:"planner-header"},te={class:"planner-header__date"},ne={class:"planner-header__buttons"},ae={__name:"PlannerHeader",props:V(["isSidebarOpened","currentMonth"],{modelValue:{},modelModifiers:{}}),emits:V(["prevWeek","nextWeek"],["update:modelValue"]),setup(l,{emit:a}){const t=a,n=O(l,"modelValue");return(c,s)=>(r(),i("header",ee,[e("span",te,m(l.currentMonth),1),e("div",ne,[e("button",{class:"planner-header__date-button planner-header__date-button--prev icon-button",onClick:s[0]||(s[0]=_=>t("prevWeek"))}),e("button",{class:"planner-header__date-button planner-header__date-button--next icon-button",onClick:s[1]||(s[1]=_=>t("nextWeek"))})]),e("label",{class:w(["sidebar-hide icon-button",{rotated:!n.value}])},[P(e("input",{type:"checkbox",class:"visually-hidden","onUpdate:modelValue":s[2]||(s[2]=_=>n.value=_)},null,512),[[z,n.value]])],2)]))}},se={},re={class:"loading-container"},le=e("div",{class:"loading-progress"},null,-1),oe=[le];function ie(l,a){return r(),i("div",re,oe)}const ce=I(se,[["render",ie]]),ue={class:"planner-date__weekday"},de={class:"planner-date__day"},_e={__name:"PlannerDate",props:["date"],setup(l){const a=l,[t,n,c]=a.date.split("-").map(Number),s=new Date(t,n-1,c),_=h(()=>s.toLocaleDateString("en-EN",{weekday:"short"})),p=h(()=>new Date().getDate()===s.getDate());return(o,v)=>(r(),i("div",{class:w(["planner-date",{current:p.value}])},[e("span",ue,m(_.value),1),e("div",de,[e("span",null,m(H(c)),1)])],2))}},ve={class:"task"},pe=["for"],me=["id"],he={__name:"TaskItem",props:["task"],setup(l){return(a,t)=>(r(),i("div",ve,[e("span",{class:"task__color",style:T({backgroundColor:l.task.color})},null,4),e("label",{class:"task__checkbox-label",for:a.title},[e("input",{class:"visually-hidden",id:a.title,type:"checkbox"},null,8,me)],8,pe),e("span",null,m(l.task.name),1)]))}},fe={class:"right-sidebar__tabs"},ke=e("span",null,"Habits",-1),ge=[ke],ye=e("span",null,"Tasks",-1),$e=[ye],be={class:"underline"},we={key:0,class:"tasks"},xe={__name:"RightSidebar",props:["isOpened"],setup(l){const a=u(),t=u(),n=u(null),c=u(null),s=u(null),_=u(M.value.tasks);return E(()=>{s.value=c.value}),R(s,()=>{a.value.style.transform=`translateX(${s.value.offsetLeft}px)`,t.value.style.transform=`translateX(${s.value.offsetLeft}px)`}),(p,o)=>(r(),i("div",{class:w(["right-sidebar",{hidden:!l.isOpened}])},[e("div",fe,[e("button",{ref_key:"habitsButton",ref:n,class:"right-sidebar__tab",onClick:o[0]||(o[0]=v=>s.value=n.value)},ge,512),e("button",{ref_key:"tasksButton",ref:c,class:"right-sidebar__tab",onClick:o[1]||(o[1]=v=>s.value=c.value)},$e,512),e("div",be,[e("div",{ref_key:"underlineRight",ref:a,class:"underline__closer underline__closer--right"},null,512),e("div",{ref_key:"underlineLeft",ref:t,class:"underline__closer underline__closer--left"},null,512)])]),s.value===c.value?(r(),i("div",we,[(r(!0),i(y,null,$(_.value,v=>(r(),b(he,{key:v.id,task:v},null,8,["task"]))),128))])):f("",!0)],2))}},Te={class:"planner-wrapper"},Le={class:"planner"},We={key:0,class:"planner__loader-wrapper"},Ce={key:1,class:"planner__grid-wrapper"},De={class:"planner__days-header"},Ve={__name:"Planner",setup(l){const a=u(!0),t=u(null),n=u(!0),c=async()=>{try{t.value=await F()}catch(o){console.error("ошибка",o)}finally{n.value=!1}},s=async()=>{if(n.value)return;n.value=!0;const o=await U(t.value.mon.date);t.value=o,n.value=!1,await L(),timeLineEl.value.scrollIntoView({block:"center"})},_=async()=>{if(n.value)return;n.value=!0;const o=await q(t.value.mon.date);t.value=o,n.value=!1,await L(),timeLineEl.value.scrollIntoView({block:"center"})},p=h(()=>{if(t.value){const o=new Date(t.value.mon.date);return`${o.toLocaleString("default",{month:"long"})} ${o.getFullYear()}`}else return""});return E(()=>{c()}),(o,v)=>(r(),i("div",Te,[e("div",Le,[C(ae,{modelValue:a.value,"onUpdate:modelValue":v[0]||(v[0]=d=>a.value=d),currentMonth:p.value,onPrevWeek:_,onNextWeek:s},null,8,["modelValue","currentMonth"]),n.value?(r(),i("div",We,[C(ce)])):f("",!0),n.value?f("",!0):(r(),i("div",Ce,[e("div",De,[(r(!0),i(y,null,$(t.value,d=>(r(),b(_e,{key:d.date,date:d.date},null,8,["date"]))),128))]),C(Z,{currentWeekEvents:t.value},null,8,["currentWeekEvents"])]))]),H(M)?(r(),b(xe,{key:0,isOpened:a.value},null,8,["isOpened"])):f("",!0)]))}};export{Ve as default};
