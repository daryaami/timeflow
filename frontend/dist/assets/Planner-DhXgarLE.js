import{m as O,e as M,f as m,o as n,c as r,b as e,t as _,g as N,v as F,n as $,_ as P,h as d,i as g,j as V,k as h,l as x,u as w,p as B,q as C,s as z,F as k,x as y,y as T,a as S,z as L,A as H}from"./index-BO33Vnrf.js";const I={class:"planner-header"},R={class:"planner-header__date"},U=e("div",{class:"planner-header__buttons"},[e("button",{class:"planner-header__date-button planner-header__date-button--prev icon-button"}),e("button",{class:"planner-header__date-button planner-header__date-button--next icon-button"})],-1),j={__name:"PlannerHeader",props:O("isSidebarOpened",{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(s){const t=M(s,"modelValue"),a=m(()=>{const l=new Date;return`${l.toLocaleString("default",{month:"long"})} ${l.getFullYear()}`});return(l,i)=>(n(),r("header",I,[e("span",R,_(a.value),1),U,e("label",{class:$(["sidebar-hide icon-button",{rotated:!t.value}])},[N(e("input",{type:"checkbox",class:"visually-hidden","onUpdate:modelValue":i[0]||(i[0]=o=>t.value=o)},null,512),[[F,t.value]])],2)]))}},X={},q={class:"loading-container"},A=e("div",{class:"loading-progress"},null,-1),Y=[A];function G(s,t){return n(),r("div",q,Y)}const J=P(X,[["render",G]]),K={key:0,class:"event-card__short-wrapper"},Q={class:"event-card__name"},W={class:"event-card__time"},Z={class:"event-card__name-wrapper"},ee={key:1,class:"event-card__time"},te={__name:"EventCard",props:["event"],setup(s){const t=s,a=d(g(t.event.end.dateTime)-g(t.event.start.dateTime)),l=d(V(t.event.start.dateTime)),i=m(()=>g(t.event.start.dateTime)*100/24),o=m(()=>a.value*100/24),p=m(()=>`${l.value} - ${V(t.event.end.dateTime)}`),f=m(()=>new Date(t.event.end.dateTime)<new Date);return(v,c)=>(n(),r("div",{class:$(["event-card",{"no-padding":a.value<=.25,"no-right-padding":a.value<=.5,past:f.value}]),style:x({top:`${i.value}%`,height:`calc(${o.value}% - 2px)`,backgroundColor:`${s.event.background_color}`,color:`${s.event.foreground_color}`})},[a.value<=.5?(n(),r("div",K,[e("span",Q,_(s.event.summary)+", ",1),e("span",W,_(l.value),1)])):h("",!0),e("div",Z,[a.value>.5?(n(),r("span",{key:0,class:$(["event-card__name",{"one-string":a.value<=1}])},_(s.event.summary),3)):h("",!0)]),a.value>.5?(n(),r("span",ee,_(p.value),1)):h("",!0)],6))}},ne=async()=>{let s=await fetch(`${window.location.origin}/planner_api/get_events/`);if(s.ok)return(await s.json()).days;throw new Error("Failed to fetch events")},se={class:"planner-date__weekday"},ae={class:"planner-date__day"},re={__name:"PlannerDate",props:["date"],setup(s){const t=s,[a,l,i]=t.date.split(".").map(Number),o=new Date(i,l-1,a),p=m(()=>o.toLocaleDateString("en-EN",{weekday:"short"})),f=m(()=>new Date().getDate()===o.getDate());return(v,c)=>(n(),r("div",{class:$(["planner-date",{current:f.value}])},[e("span",se,_(p.value),1),e("div",ae,[e("span",null,_(w(a)),1)])],2))}},le={class:"task"},oe=["for"],ie=["id"],ce={__name:"TaskItem",props:["task"],setup(s){return(t,a)=>(n(),r("div",le,[e("span",{class:"task__color",style:x({backgroundColor:s.task.color})},null,4),e("label",{class:"task__checkbox-label",for:t.title},[e("input",{class:"visually-hidden",id:t.title,type:"checkbox"},null,8,ie)],8,oe),e("span",null,_(s.task.name),1)]))}},de={class:"right-sidebar__tabs"},ue=e("span",null,"Habits",-1),_e=[ue],pe=e("span",null,"Tasks",-1),ve=[pe],me={class:"underline"},he={key:0,class:"tasks"},fe={__name:"RightSidebar",props:["isOpened"],setup(s){const t=d(),a=d(),l=d(null),i=d(null),o=d(null),p=d(B.value.tasks);return C(()=>{o.value=i.value}),z(o,()=>{t.value.style.transform=`translateX(${o.value.offsetLeft}px)`,a.value.style.transform=`translateX(${o.value.offsetLeft}px)`}),(f,v)=>(n(),r("div",{class:$(["right-sidebar",{hidden:!s.isOpened}])},[e("div",de,[e("button",{ref_key:"habitsButton",ref:l,class:"right-sidebar__tab",onClick:v[0]||(v[0]=c=>o.value=l.value)},_e,512),e("button",{ref_key:"tasksButton",ref:i,class:"right-sidebar__tab",onClick:v[1]||(v[1]=c=>o.value=i.value)},ve,512),e("div",me,[e("div",{ref_key:"underlineRight",ref:t,class:"underline__closer underline__closer--right"},null,512),e("div",{ref_key:"underlineLeft",ref:a,class:"underline__closer underline__closer--left"},null,512)])]),o.value===i.value?(n(),r("div",he,[(n(!0),r(k,null,y(p.value,c=>(n(),T(ce,{key:c.id,task:c},null,8,["task"]))),128))])):h("",!0)],2))}},ke={class:"planner-wrapper"},ye={class:"planner"},$e={key:0,class:"planner__loader-wrapper"},be={key:1,class:"planner__grid-wrapper"},ge={class:"planner__days-header"},we={class:"planner__grid"},Te={class:"planner__line-time"},xe={class:"planner__line-time"},Le={__name:"Planner",setup(s){const t=d(!0),a=d(null),l=d({caption:"",styleTop:""}),i=()=>{const c=new Date;l.value.caption=V(c),l.value.styleTop=`${g(c)*100/24}%`},o=async()=>{i(),await H(),a.value.scrollIntoView({block:"center"});const b=(60-new Date().getSeconds())*1e3;setTimeout(()=>{i(),setInterval(i,6e4)},b)},p=d(!0),f=async()=>{try{L.value=await ne()}catch(c){console.error("ошибка",c)}finally{p.value=!1,o()}};C(()=>{f()});const v=[{time:"01:00",percent:100/24},{time:"02:00",percent:200/24},{time:"03:00",percent:300/24},{time:"04:00",percent:400/24},{time:"05:00",percent:500/24},{time:"06:00",percent:600/24},{time:"07:00",percent:700/24},{time:"08:00",percent:800/24},{time:"09:00",percent:900/24},{time:"10:00",percent:1e3/24},{time:"11:00",percent:1100/24},{time:"12:00",percent:1200/24},{time:"13:00",percent:1300/24},{time:"14:00",percent:1400/24},{time:"15:00",percent:1500/24},{time:"16:00",percent:1600/24},{time:"17:00",percent:1700/24},{time:"18:00",percent:1800/24},{time:"19:00",percent:1900/24},{time:"20:00",percent:2e3/24},{time:"21:00",percent:2100/24},{time:"22:00",percent:2200/24},{time:"23:00",percent:2300/24}];return(c,b)=>(n(),r("div",ke,[e("div",ye,[S(j,{modelValue:t.value,"onUpdate:modelValue":b[0]||(b[0]=u=>t.value=u)},null,8,["modelValue"]),p.value?(n(),r("div",$e,[S(J)])):h("",!0),p.value?h("",!0):(n(),r("div",be,[e("div",ge,[(n(!0),r(k,null,y(w(L),u=>(n(),T(re,{key:u.date,date:u.date},null,8,["date"]))),128))]),e("div",we,[(n(!0),r(k,null,y(w(L),u=>(n(),r("div",{class:"planner__day-column",key:u.date},[(n(!0),r(k,null,y(u.events,(D,E)=>(n(),T(te,{key:E,event:D},null,8,["event"]))),128))]))),128)),(n(),r(k,null,y(v,(u,D)=>e("div",{class:"planner__line",key:D,style:x({top:`${u.percent}%`})},[e("div",Te,_(u.time),1)],4)),64)),e("div",{class:"planner__line planner__line--now",style:x({top:`${l.value.styleTop}`}),ref_key:"timeLineEl",ref:a},[e("div",xe,_(l.value.caption),1)],4)])]))]),w(B)?(n(),T(fe,{key:0,isOpened:t.value},null,8,["isOpened"])):h("",!0)]))}};export{Le as default};
