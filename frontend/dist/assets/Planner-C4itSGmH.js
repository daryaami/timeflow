import{e as _,g as T,f as H,h as $,r as I,o as l,i as D,w as N,c as i,b as t,t as m,j as f,n as x,k as L,l as W,m as C,F as w,p as b,u as P,q as B,s as R,v as F,x as U,_ as q,y as z,z as X,a as M,A as V,B as O,C as S}from"./index-CquiXBs1.js";const j={key:0,class:"event-card__short-wrapper"},A={class:"event-card__name"},G={class:"event-card__time"},Y={class:"event-card__name-wrapper"},J={key:1,class:"event-card__time"},K={__name:"EventCard",props:["event","gridHeight"],setup(o){const s=o,e=_(T(s.event.end.dateTime)-T(s.event.start.dateTime)),a=_(H(s.event.start.dateTime)),c=$(()=>T(s.event.start.dateTime)*100/24),d=$(()=>Math.max(e.value,.25)*100/24),v=$(()=>`${a.value} - ${H(s.event.end.dateTime)}`),p=$(()=>new Date(s.event.end.dateTime)<new Date),y=$(()=>s.gridHeight?[10,s.gridHeight/96]:[0,0]);return(n,u)=>{const r=I("vue-draggable-resizable");return o.gridHeight?(l(),D(r,{key:0,class:x(["event-card",{"no-padding":e.value<=.25,"no-right-padding":e.value<=.5,past:p.value}]),axis:"y",grid:y.value,handles:["tm","bm"],active:!0,style:L({top:`${c.value}%`,height:`calc(${d.value}% - 2px)`,backgroundColor:`${o.event.background_color}`,color:`${o.event.foreground_color}`})},{default:N(()=>[e.value<=.5?(l(),i("div",j,[t("span",A,m(o.event.summary)+", ",1),t("span",G,m(a.value),1)])):f("",!0),t("div",Y,[e.value>.5?(l(),i("span",{key:0,class:x(["event-card__name",{"one-string":e.value<=1}])},m(o.event.summary),3)):f("",!0)]),e.value>.5?(l(),i("span",J,m(v.value),1)):f("",!0)]),_:1},8,["grid","style","class"])):f("",!0)}}},Q=[{time:"01:00",percent:100/24},{time:"02:00",percent:200/24},{time:"03:00",percent:300/24},{time:"04:00",percent:400/24},{time:"05:00",percent:500/24},{time:"06:00",percent:600/24},{time:"07:00",percent:700/24},{time:"08:00",percent:800/24},{time:"09:00",percent:900/24},{time:"10:00",percent:1e3/24},{time:"11:00",percent:1100/24},{time:"12:00",percent:1200/24},{time:"13:00",percent:1300/24},{time:"14:00",percent:1400/24},{time:"15:00",percent:1500/24},{time:"16:00",percent:1600/24},{time:"17:00",percent:1700/24},{time:"18:00",percent:1800/24},{time:"19:00",percent:1900/24},{time:"20:00",percent:2e3/24},{time:"21:00",percent:2100/24},{time:"22:00",percent:2200/24},{time:"23:00",percent:2300/24}],Z={class:"planner__line-time"},ee={class:"planner__line-time"},te={__name:"PlannerGrid",props:["days"],setup(o){const s=_(null),e=_(),a=_(null),c=_(null),d=_({caption:"",styleTop:""}),v=()=>{c.value.style.display="none";const n=document.querySelector(".planner-date.current");if(!n)return;const u=(n.getBoundingClientRect().left-a.value.getBoundingClientRect().left)/a.value.offsetWidth*100,r=n.offsetWidth*.9/a.value.offsetWidth*100;c.value.style.left=`${u}%`,c.value.style.width=`${r}%`,c.value.style.display="block"},p=()=>{const n=new Date;d.value.caption=H(n),d.value.styleTop=`${T(n)*100/24}%`},y=async()=>{p(),await C(),v(),a.value.scrollIntoView({block:"center"});const u=(60-new Date().getSeconds())*1e3;setTimeout(()=>{p(),setInterval(p,6e4)},u)};return W(async()=>{await C(),y(),e.value=s.value.offsetHeight}),(n,u)=>(l(),i("div",{class:"planner__grid",ref_key:"grid",ref:s},[(l(!0),i(w,null,b(o.days,r=>(l(),i("div",{class:"planner__day-column",key:r.date},[(l(!0),i(w,null,b(r.events,(k,h)=>(l(),D(K,{key:h,event:k,gridHeight:e.value},null,8,["event","gridHeight"]))),128))]))),128)),(l(!0),i(w,null,b(P(Q),(r,k)=>(l(),i("div",{class:"planner__line",key:k,style:L({top:`${r.percent}%`})},[t("div",Z,m(r.time),1)],4))),128)),t("div",{class:"planner__line planner__line--now",style:L({top:`${d.value.styleTop}`}),ref_key:"timeLineEl",ref:a},[t("div",ee,m(d.value.caption),1),t("div",{class:"planner__line-today-line",ref_key:"todayLine",ref:c},null,512)],4)],512))}},ne={class:"planner-header"},ae={class:"planner-header__date"},se={class:"planner-header__buttons"},le={__name:"PlannerHeader",props:B(["isSidebarOpened","currentMonth"],{modelValue:{},modelModifiers:{}}),emits:B(["prevWeek","nextWeek"],["update:modelValue"]),setup(o,{emit:s}){const e=s,a=R(o,"modelValue");return(c,d)=>(l(),i("header",ne,[t("span",ae,m(o.currentMonth),1),t("div",se,[t("button",{class:"planner-header__date-button planner-header__date-button--prev icon-button",onClick:d[0]||(d[0]=v=>e("prevWeek"))}),t("button",{class:"planner-header__date-button planner-header__date-button--next icon-button",onClick:d[1]||(d[1]=v=>e("nextWeek"))})]),t("label",{class:x(["sidebar-hide icon-button",{rotated:!a.value}])},[F(t("input",{type:"checkbox",class:"visually-hidden","onUpdate:modelValue":d[2]||(d[2]=v=>a.value=v)},null,512),[[U,a.value]])],2)]))}},re={},oe={class:"loading-container"},ie=t("div",{class:"loading-progress"},null,-1),ce=[ie];function de(o,s){return l(),i("div",oe,ce)}const ue=q(re,[["render",de]]),_e={class:"planner-date__weekday"},ve={class:"planner-date__day"},pe={__name:"PlannerDate",props:["day"],setup(o){return(s,e)=>(l(),i("div",{class:x(["planner-date",{current:o.day.isToday}])},[t("span",_e,m(o.day.weekday),1),t("div",ve,[t("span",null,m(o.day.date),1)])],2))}},me={class:"task"},ye=["for"],he=["id"],fe={__name:"TaskItem",props:["task"],setup(o){return(s,e)=>(l(),i("div",me,[t("span",{class:"task__color",style:L({backgroundColor:o.task.color})},null,4),t("label",{class:"task__checkbox-label",for:s.title},[t("input",{class:"visually-hidden",id:s.title,type:"checkbox"},null,8,he)],8,ye),t("span",null,m(o.task.name),1)]))}},ge={class:"right-sidebar__tabs"},ke=t("span",null,"Tasks",-1),$e=[ke],we={class:"underline"},be={key:0,class:"tasks"},De={__name:"RightSidebar",props:["isOpened"],setup(o){const s=_(),e=_();_(null);const a=_(null),c=_(null),d=_(z.value.tasks);return W(()=>{c.value=a.value}),X(c,()=>{s.value.style.transform=`translateX(${c.value.offsetLeft}px)`,e.value.style.transform=`translateX(${c.value.offsetLeft}px)`}),(v,p)=>(l(),i("div",{class:x(["right-sidebar",{hidden:!o.isOpened}])},[t("div",ge,[t("button",{ref_key:"tasksButton",ref:a,class:"right-sidebar__tab",onClick:p[0]||(p[0]=y=>c.value=a.value)},$e,512),t("div",we,[t("div",{ref_key:"underlineRight",ref:s,class:"underline__closer underline__closer--right"},null,512),t("div",{ref_key:"underlineLeft",ref:e,class:"underline__closer underline__closer--left"},null,512)])]),c.value===a.value?(l(),i("div",be,[(l(!0),i(w,null,b(d.value,y=>(l(),D(fe,{key:y.id,task:y},null,8,["task"]))),128))])):f("",!0)],2))}},xe={class:"planner-wrapper"},Te={class:"planner"},Le={key:0,class:"planner__loader-wrapper"},Ce={key:1,class:"planner__grid-wrapper"},Me={class:"planner__days-header"},Se={__name:"Planner",setup(o){const s=_(!0),e=_([]),a=_(!0),c=(n,u)=>{const r=n.getDay(),k=new Date(n.setDate(n.getDate()-r+1));e.value=[];for(let h=0;h<7;h++){const g=new Date(k);g.setDate(k.getDate()+h),e.value.push({weekday:g.toLocaleDateString("en-EN",{weekday:"short"}),date:g.getDate(),isToday:S(g,new Date),day:g,events:[]})}e.value.forEach(h=>{const g=u.filter(E=>S(h.day,new Date(E.start.dateTime))||S(h.day,new Date(E.end.dateTime)));h.events=g}),console.log(e.value)},d=async()=>{try{const n=await V();c(new Date,n)}catch(n){console.error("ошибка",n)}finally{a.value=!1}},v=async()=>{if(a.value)return;a.value=!0;const n=e.value[0].day,u=new Date(n.setDate(n.getDate()+7));try{const r=await V(O(u));c(u,r)}catch(r){console.error("ошибка",r)}finally{a.value=!1,await C(),timeLineEl.value.scrollIntoView({block:"center"})}},p=async()=>{if(a.value)return;a.value=!0;const n=e.value[0].day,u=new Date(n.setDate(n.getDate()-7));try{const r=await V(O(u));c(u,r)}catch(r){console.error("ошибка",r)}finally{a.value=!1,await C(),timeLineEl.value.scrollIntoView({block:"center"})}},y=$(()=>{if(e.value.length){const n=e.value[0].day;return`${n.toLocaleString("default",{month:"long"})} ${n.getFullYear()}`}else return""});return W(()=>{d()}),(n,u)=>(l(),i("div",xe,[t("div",Te,[M(le,{modelValue:s.value,"onUpdate:modelValue":u[0]||(u[0]=r=>s.value=r),currentMonth:y.value,onPrevWeek:p,onNextWeek:v},null,8,["modelValue","currentMonth"]),a.value?(l(),i("div",Le,[M(ue)])):f("",!0),a.value?f("",!0):(l(),i("div",Ce,[t("div",Me,[(l(!0),i(w,null,b(e.value,r=>(l(),D(pe,{key:r.date,day:r},null,8,["day"]))),128))]),M(te,{days:e.value},null,8,["days"])]))]),P(z)?(l(),D(De,{key:0,isOpened:s.value},null,8,["isOpened"])):f("",!0)]))}};export{Se as default};
