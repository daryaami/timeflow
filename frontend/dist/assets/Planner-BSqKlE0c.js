import{e as u,g as w,f as D,h,r as M,o as r,i as b,w as S,c as i,b as e,t as p,j as k,n as $,k as x,l as L,m as T,F as f,p as y,q as W,s as B,v as N,x as O,_ as P,u as V,y as C,z,a as E,A as I,B as F,C as R}from"./index-B3g28Mqe.js";const U={key:0,class:"event-card__short-wrapper"},X={class:"event-card__name"},j={class:"event-card__time"},q={class:"event-card__name-wrapper"},A={key:1,class:"event-card__time"},G={__name:"EventCard",props:["event","gridHeight"],setup(o){const n=o,t=u(w(n.event.end.dateTime)-w(n.event.start.dateTime)),s=u(D(n.event.start.dateTime)),c=h(()=>w(n.event.start.dateTime)*100/24),a=h(()=>t.value*100/24),d=h(()=>`${s.value} - ${D(n.event.end.dateTime)}`),m=h(()=>new Date(n.event.end.dateTime)<new Date),l=h(()=>n.gridHeight?[10,n.gridHeight/96]:[0,0]);return(_,v)=>{const g=M("vue-draggable-resizable");return o.gridHeight?(r(),b(g,{key:0,class:$(["event-card",{"no-padding":t.value<=.25,"no-right-padding":t.value<=.5,past:m.value}]),axis:"y",grid:l.value,handles:["tm","bm"],active:!0,style:x({top:`${c.value}%`,height:`calc(${a.value}% - 2px)`,backgroundColor:`${o.event.background_color}`,color:`${o.event.foreground_color}`})},{default:S(()=>[t.value<=.5?(r(),i("div",U,[e("span",X,p(o.event.summary)+", ",1),e("span",j,p(s.value),1)])):k("",!0),e("div",q,[t.value>.5?(r(),i("span",{key:0,class:$(["event-card__name",{"one-string":t.value<=1}])},p(o.event.summary),3)):k("",!0)]),t.value>.5?(r(),i("span",A,p(d.value),1)):k("",!0)]),_:1},8,["grid","style","class"])):k("",!0)}}},Y={class:"planner__line-time"},J={class:"planner__line-time"},K={__name:"PlannerGrid",props:["currentWeekEvents"],setup(o){const n=u(null),t=u(),s=u(null),c=u({caption:"",styleTop:""}),a=()=>{const l=new Date;c.value.caption=D(l),c.value.styleTop=`${w(l)*100/24}%`},d=async()=>{a(),await T(),s.value.scrollIntoView({block:"center"});const _=(60-new Date().getSeconds())*1e3;setTimeout(()=>{a(),setInterval(a,6e4)},_)},m=[{time:"01:00",percent:100/24},{time:"02:00",percent:200/24},{time:"03:00",percent:300/24},{time:"04:00",percent:400/24},{time:"05:00",percent:500/24},{time:"06:00",percent:600/24},{time:"07:00",percent:700/24},{time:"08:00",percent:800/24},{time:"09:00",percent:900/24},{time:"10:00",percent:1e3/24},{time:"11:00",percent:1100/24},{time:"12:00",percent:1200/24},{time:"13:00",percent:1300/24},{time:"14:00",percent:1400/24},{time:"15:00",percent:1500/24},{time:"16:00",percent:1600/24},{time:"17:00",percent:1700/24},{time:"18:00",percent:1800/24},{time:"19:00",percent:1900/24},{time:"20:00",percent:2e3/24},{time:"21:00",percent:2100/24},{time:"22:00",percent:2200/24},{time:"23:00",percent:2300/24}];return L(async()=>{await T(),d(),t.value=n.value.offsetHeight}),(l,_)=>(r(),i("div",{class:"planner__grid",ref_key:"grid",ref:n},[(r(!0),i(f,null,y(o.currentWeekEvents,v=>(r(),i("div",{class:"planner__day-column",key:v.date},[(r(!0),i(f,null,y(v.events,(g,H)=>(r(),b(G,{key:H,event:g,gridHeight:t.value},null,8,["event","gridHeight"]))),128))]))),128)),(r(),i(f,null,y(m,(v,g)=>e("div",{class:"planner__line",key:g,style:x({top:`${v.percent}%`})},[e("div",Y,p(v.time),1)],4)),64)),e("div",{class:"planner__line planner__line--now",style:x({top:`${c.value.styleTop}`}),ref_key:"timeLineEl",ref:s},[e("div",J,p(c.value.caption),1)],4)],512))}},Q={class:"planner-header"},Z={class:"planner-header__date"},ee={class:"planner-header__buttons"},te={__name:"PlannerHeader",props:W(["isSidebarOpened","currentMonth"],{modelValue:{},modelModifiers:{}}),emits:W(["prevWeek","nextWeek"],["update:modelValue"]),setup(o,{emit:n}){const t=n,s=B(o,"modelValue");return(c,a)=>(r(),i("header",Q,[e("span",Z,p(o.currentMonth),1),e("div",ee,[e("button",{class:"planner-header__date-button planner-header__date-button--prev icon-button",onClick:a[0]||(a[0]=d=>t("prevWeek"))}),e("button",{class:"planner-header__date-button planner-header__date-button--next icon-button",onClick:a[1]||(a[1]=d=>t("nextWeek"))})]),e("label",{class:$(["sidebar-hide icon-button",{rotated:!s.value}])},[N(e("input",{type:"checkbox",class:"visually-hidden","onUpdate:modelValue":a[2]||(a[2]=d=>s.value=d)},null,512),[[O,s.value]])],2)]))}},ne={},ae={class:"loading-container"},se=e("div",{class:"loading-progress"},null,-1),re=[se];function le(o,n){return r(),i("div",ae,re)}const oe=P(ne,[["render",le]]),ie={class:"planner-date__weekday"},ce={class:"planner-date__day"},ue={__name:"PlannerDate",props:["date"],setup(o){const n=o,[t,s,c]=n.date.split("-").map(Number),a=new Date(t,s-1,c),d=h(()=>a.toLocaleDateString("en-EN",{weekday:"short"})),m=h(()=>new Date().getDate()===a.getDate());return(l,_)=>(r(),i("div",{class:$(["planner-date",{current:m.value}])},[e("span",ie,p(d.value),1),e("div",ce,[e("span",null,p(V(c)),1)])],2))}},de={class:"task"},_e=["for"],ve=["id"],pe={__name:"TaskItem",props:["task"],setup(o){return(n,t)=>(r(),i("div",de,[e("span",{class:"task__color",style:x({backgroundColor:o.task.color})},null,4),e("label",{class:"task__checkbox-label",for:n.title},[e("input",{class:"visually-hidden",id:n.title,type:"checkbox"},null,8,ve)],8,_e),e("span",null,p(o.task.name),1)]))}},me={class:"right-sidebar__tabs"},he=e("span",null,"Habits",-1),ke=[he],ge=e("span",null,"Tasks",-1),fe=[ge],ye={class:"underline"},be={key:0,class:"tasks"},$e={__name:"RightSidebar",props:["isOpened"],setup(o){const n=u(),t=u(),s=u(null),c=u(null),a=u(null),d=u(C.value.tasks);return L(()=>{a.value=c.value}),z(a,()=>{n.value.style.transform=`translateX(${a.value.offsetLeft}px)`,t.value.style.transform=`translateX(${a.value.offsetLeft}px)`}),(m,l)=>(r(),i("div",{class:$(["right-sidebar",{hidden:!o.isOpened}])},[e("div",me,[e("button",{ref_key:"habitsButton",ref:s,class:"right-sidebar__tab",onClick:l[0]||(l[0]=_=>a.value=s.value)},ke,512),e("button",{ref_key:"tasksButton",ref:c,class:"right-sidebar__tab",onClick:l[1]||(l[1]=_=>a.value=c.value)},fe,512),e("div",ye,[e("div",{ref_key:"underlineRight",ref:n,class:"underline__closer underline__closer--right"},null,512),e("div",{ref_key:"underlineLeft",ref:t,class:"underline__closer underline__closer--left"},null,512)])]),a.value===c.value?(r(),i("div",be,[(r(!0),i(f,null,y(d.value,_=>(r(),b(pe,{key:_.id,task:_},null,8,["task"]))),128))])):k("",!0)],2))}},we={class:"planner-wrapper"},xe={class:"planner"},Te={key:0,class:"planner__loader-wrapper"},Ee={key:1,class:"planner__grid-wrapper"},De={class:"planner__days-header"},We={__name:"Planner",setup(o){const n=u(!0),t=u(null),s=u(!0),c=async()=>{try{t.value=await I()}catch(l){console.error("ошибка",l)}finally{s.value=!1}},a=async()=>{if(s.value)return;s.value=!0;const l=await F(t.value.mon.date);t.value=l,s.value=!1,await T(),timeLineEl.value.scrollIntoView({block:"center"})},d=async()=>{if(s.value)return;s.value=!0;const l=await R(t.value.mon.date);t.value=l,s.value=!1,await T(),timeLineEl.value.scrollIntoView({block:"center"})},m=h(()=>{if(t.value){const l=new Date(t.value.mon.date);return`${l.toLocaleString("default",{month:"long"})} ${l.getFullYear()}`}else return""});return L(()=>{c()}),(l,_)=>(r(),i("div",we,[e("div",xe,[E(te,{modelValue:n.value,"onUpdate:modelValue":_[0]||(_[0]=v=>n.value=v),currentMonth:m.value,onPrevWeek:d,onNextWeek:a},null,8,["modelValue","currentMonth"]),s.value?(r(),i("div",Te,[E(oe)])):k("",!0),s.value?k("",!0):(r(),i("div",Ee,[e("div",De,[(r(!0),i(f,null,y(t.value,v=>(r(),b(ue,{key:v.date,date:v.date},null,8,["date"]))),128))]),E(K,{currentWeekEvents:t.value},null,8,["currentWeekEvents"])]))]),V(C)?(r(),b($e,{key:0,isOpened:n.value},null,8,["isOpened"])):k("",!0)]))}};export{We as default};
