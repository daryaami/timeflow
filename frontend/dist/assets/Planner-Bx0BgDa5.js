import{_ as L,o as n,c as s,b as t,n as E,e as p,t as u,f as b,g as h,h as k,i as g,j as B,a as T,k as x,F as m,l as v,u as D,m as w,p as S,q as V}from"./index-CJP96mOB.js";const C={props:{isSidebarHidden:Boolean},emits:{"update:isSidebarHidden":Boolean}},N={class:"planner-header"},F={class:"planner-header__date"},P=t("span",null,"February 2024",-1),j=t("div",{class:"planner-header__date-buttons"},[t("button",{class:"planner-header__date-button planner-header__date-button--prev"}),t("button",{class:"planner-header__date-button planner-header__date-button--next"})],-1);function z(a,e,r,c,d,o){return n(),s("header",N,[t("div",F,[P,j,t("button",{class:E(["sidebar-hide",{rotated:r.isSidebarHidden}]),onClick:e[0]||(e[0]=_=>a.$emit("update:isSidebarHidden",!r.isSidebarHidden))},null,2)])])}const I=L(C,[["render",z]]),M={},q={class:"loading-container"},U=t("div",{class:"loading-progress"},null,-1),A=[U];function G(a,e){return n(),s("div",q,A)}const J=L(M,[["render",G]]),K={class:"event-card__name"},O={class:"event-card__time"},Q={__name:"EventCard",props:["event"],setup(a){const e=a,r=p(()=>h(e.event.start.dateTime)*100/24),c=p(()=>(h(e.event.end.dateTime)-h(e.event.start.dateTime))*100/24),d=p(()=>`${k(e.event.start.dateTime)} - ${k(e.event.end.dateTime)}`);return(o,_)=>(n(),s("div",{class:"event-card",style:b({top:`${r.value}%`,height:`calc(${c.value}% - 2px)`,backgroundColor:`${a.event.background_color}`,color:`${a.event.foreground_color}`})},[t("span",K,u(a.event.summary),1),t("span",O,u(d.value),1)],4))}},R=async()=>{let a=await fetch(`${window.location.origin}/planner_api/get_events/`);if(a.ok)return(await a.json()).days;throw new Error("Failed to fetch events")},W={__name:"PlannerDate",props:["date"],setup(a){const e=a,[r,c,d]=e.date.split(".").map(Number),o=new Date(d,c-1,r),_=p(()=>`${o.toLocaleDateString("en-EN",{weekday:"short"})} ${o.getDate()}`),$=p(()=>new Date().getDate()===o.getDate());return(i,y)=>(n(),s("span",{class:E(["planner-date",{current:$.value}])},u(_.value),3))}},X={class:"planner"},Y={key:0,class:"planner__loader-wrapper"},Z={key:1,class:"planner__grid-wrapper"},ee={class:"planner__days-header"},te={class:"planner__grid"},ne={class:"planner__line-time"},ae={class:"planner__line-time"},re={__name:"Planner",setup(a){const e=g(null),r=g({caption:"",styleTop:""}),c=()=>{const i=new Date;r.value.caption=k(i),r.value.styleTop=`${h(i)*100/24}%`},d=async()=>{c(),await V(),e.value.scrollIntoView({block:"center"});const y=(60-new Date().getSeconds())*1e3;setTimeout(()=>{c(),setInterval(c,6e4)},y)},o=g(!0),_=async()=>{try{w.value=await R()}catch(i){console.error("ошибка",i)}finally{o.value=!1,d()}};B(()=>{_()});const $=[{time:"01:00",percent:100/24},{time:"02:00",percent:200/24},{time:"03:00",percent:300/24},{time:"04:00",percent:400/24},{time:"05:00",percent:500/24},{time:"06:00",percent:600/24},{time:"07:00",percent:700/24},{time:"08:00",percent:800/24},{time:"09:00",percent:900/24},{time:"10:00",percent:1e3/24},{time:"11:00",percent:1100/24},{time:"12:00",percent:1200/24},{time:"13:00",percent:1300/24},{time:"14:00",percent:1400/24},{time:"15:00",percent:1500/24},{time:"16:00",percent:1600/24},{time:"17:00",percent:1700/24},{time:"18:00",percent:1800/24},{time:"19:00",percent:1900/24},{time:"20:00",percent:2e3/24},{time:"21:00",percent:2100/24},{time:"22:00",percent:2200/24},{time:"23:00",percent:2300/24}];return(i,y)=>(n(),s("div",X,[T(I),o.value?(n(),s("div",Y,[T(J)])):x("",!0),o.value?x("",!0):(n(),s("div",Z,[t("div",ee,[(n(!0),s(m,null,v(D(w),l=>(n(),S(W,{key:l.date,date:l.date},null,8,["date"]))),128))]),t("div",te,[(n(!0),s(m,null,v(D(w),l=>(n(),s("div",{class:"planner__day-column",key:l.date},[(n(!0),s(m,null,v(l.events,(f,H)=>(n(),S(Q,{key:H,event:f},null,8,["event"]))),128))]))),128)),(n(),s(m,null,v($,(l,f)=>t("div",{class:"planner__line",key:f,style:b({top:`${l.percent}%`})},[t("div",ne,u(l.time),1)],4)),64)),t("div",{class:"planner__line planner__line--now",style:b({top:`${r.value.styleTop}`}),ref_key:"timeLineEl",ref:e},[t("div",ae,u(r.value.caption),1)],4)])]))]))}};export{re as default};
