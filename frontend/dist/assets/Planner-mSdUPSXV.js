import{m as O,e as M,o as n,c as a,b as e,n as $,f as N,v as F,_ as z,g as d,h as g,i as V,j as y,t as v,k as m,l as x,p as B,q as C,s as H,F as f,x as k,y as w,a as S,u as D,z as L,A as I}from"./index-BWBad0BZ.js";const P={class:"planner-header"},R={class:"planner-header__date"},U=e("span",null,"February 2024",-1),j=e("div",{class:"planner-header__date-buttons"},[e("button",{class:"planner-header__date-button planner-header__date-button--prev"}),e("button",{class:"planner-header__date-button planner-header__date-button--next"})],-1),X={__name:"PlannerHeader",props:O("isSidebarOpened",{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(s){const t=M(s,"modelValue");return(r,l)=>(n(),a("header",P,[e("div",R,[U,j,e("label",{class:$(["sidebar-hide icon-button",{rotated:!t.value}])},[N(e("input",{type:"checkbox",class:"visually-hidden","onUpdate:modelValue":l[0]||(l[0]=i=>t.value=i)},null,512),[[F,t.value]])],2)])]))}},q={},A={class:"loading-container"},G=e("div",{class:"loading-progress"},null,-1),J=[G];function K(s,t){return n(),a("div",A,J)}const Q=z(q,[["render",K]]),W={key:0,class:"event-card__short-wrapper"},Y={class:"event-card__name"},Z={class:"event-card__time"},ee={class:"event-card__name-wrapper"},te={key:1,class:"event-card__time"},ne={__name:"EventCard",props:["event"],setup(s){const t=s,r=d(g(t.event.end.dateTime)-g(t.event.start.dateTime)),l=d(V(t.event.start.dateTime)),i=y(()=>g(t.event.start.dateTime)*100/24),o=y(()=>r.value*100/24),_=y(()=>`${l.value} - ${V(t.event.end.dateTime)}`);return console.log(r.value),(h,p)=>(n(),a("div",{class:$(["event-card",{"no-padding":r.value<=.25,"no-right-padding":r.value<=.5}]),style:x({top:`${i.value}%`,height:`calc(${o.value}% - 2px)`,backgroundColor:`${s.event.background_color}`,color:`${s.event.foreground_color}`})},[r.value<=.5?(n(),a("div",W,[e("span",Y,v(s.event.summary)+", ",1),e("span",Z,v(l.value),1)])):m("",!0),e("div",ee,[r.value>.5?(n(),a("span",{key:0,class:$(["event-card__name",{"one-string":r.value<=1}])},v(s.event.summary),3)):m("",!0)]),r.value>.5?(n(),a("span",te,v(_.value),1)):m("",!0)],6))}},se=async()=>{let s=await fetch(`${window.location.origin}/planner_api/get_events/`);if(s.ok)return(await s.json()).days;throw new Error("Failed to fetch events")},ae={__name:"PlannerDate",props:["date"],setup(s){const t=s,[r,l,i]=t.date.split(".").map(Number),o=new Date(i,l-1,r),_=y(()=>`${o.toLocaleDateString("en-EN",{weekday:"short"})} ${o.getDate()}`),h=y(()=>new Date().getDate()===o.getDate());return(p,c)=>(n(),a("span",{class:$(["planner-date",{current:h.value}])},v(_.value),3))}},re={class:"task"},le=["for"],oe=["id"],ie={__name:"TaskItem",props:["task"],setup(s){return(t,r)=>(n(),a("div",re,[e("span",{class:"task__color",style:x({backgroundColor:s.task.color})},null,4),e("label",{class:"task__checkbox-label",for:t.title},[e("input",{class:"visually-hidden",id:t.title,type:"checkbox"},null,8,oe)],8,le),e("span",null,v(s.task.name),1)]))}},ce={class:"right-sidebar__tabs"},de=e("span",null,"Habits",-1),ue=[de],_e=e("span",null,"Tasks",-1),pe=[_e],ve={class:"underline"},me={key:0,class:"tasks"},he={__name:"RightSidebar",props:["isOpened"],setup(s){const t=d(),r=d(),l=d(null),i=d(null),o=d(null),_=d(B.value.tasks);return C(()=>{o.value=i.value}),H(o,()=>{t.value.style.transform=`translateX(${o.value.offsetLeft}px)`,r.value.style.transform=`translateX(${o.value.offsetLeft}px)`}),(h,p)=>(n(),a("div",{class:$(["right-sidebar",{hidden:!s.isOpened}])},[e("div",ce,[e("button",{ref_key:"habitsButton",ref:l,class:"right-sidebar__tab",onClick:p[0]||(p[0]=c=>o.value=l.value)},ue,512),e("button",{ref_key:"tasksButton",ref:i,class:"right-sidebar__tab",onClick:p[1]||(p[1]=c=>o.value=i.value)},pe,512),e("div",ve,[e("div",{ref_key:"underlineRight",ref:t,class:"underline__closer underline__closer--right"},null,512),e("div",{ref_key:"underlineLeft",ref:r,class:"underline__closer underline__closer--left"},null,512)])]),o.value===i.value?(n(),a("div",me,[(n(!0),a(f,null,k(_.value,c=>(n(),w(ie,{key:c.id,task:c},null,8,["task"]))),128))])):m("",!0)],2))}},fe={class:"planner-wrapper"},ke={class:"planner"},ye={key:0,class:"planner__loader-wrapper"},$e={key:1,class:"planner__grid-wrapper"},be={class:"planner__days-header"},ge={class:"planner__grid"},we={class:"planner__line-time"},xe={class:"planner__line-time"},De={__name:"Planner",setup(s){const t=d(!0),r=d(null),l=d({caption:"",styleTop:""}),i=()=>{const c=new Date;l.value.caption=V(c),l.value.styleTop=`${g(c)*100/24}%`},o=async()=>{i(),await I(),r.value.scrollIntoView({block:"center"});const b=(60-new Date().getSeconds())*1e3;setTimeout(()=>{i(),setInterval(i,6e4)},b)},_=d(!0),h=async()=>{try{L.value=await se()}catch(c){console.error("ошибка",c)}finally{_.value=!1,o()}};C(()=>{h()});const p=[{time:"01:00",percent:100/24},{time:"02:00",percent:200/24},{time:"03:00",percent:300/24},{time:"04:00",percent:400/24},{time:"05:00",percent:500/24},{time:"06:00",percent:600/24},{time:"07:00",percent:700/24},{time:"08:00",percent:800/24},{time:"09:00",percent:900/24},{time:"10:00",percent:1e3/24},{time:"11:00",percent:1100/24},{time:"12:00",percent:1200/24},{time:"13:00",percent:1300/24},{time:"14:00",percent:1400/24},{time:"15:00",percent:1500/24},{time:"16:00",percent:1600/24},{time:"17:00",percent:1700/24},{time:"18:00",percent:1800/24},{time:"19:00",percent:1900/24},{time:"20:00",percent:2e3/24},{time:"21:00",percent:2100/24},{time:"22:00",percent:2200/24},{time:"23:00",percent:2300/24}];return(c,b)=>(n(),a("div",fe,[e("div",ke,[S(X,{modelValue:t.value,"onUpdate:modelValue":b[0]||(b[0]=u=>t.value=u)},null,8,["modelValue"]),_.value?(n(),a("div",ye,[S(Q)])):m("",!0),_.value?m("",!0):(n(),a("div",$e,[e("div",be,[(n(!0),a(f,null,k(D(L),u=>(n(),w(ae,{key:u.date,date:u.date},null,8,["date"]))),128))]),e("div",ge,[(n(!0),a(f,null,k(D(L),u=>(n(),a("div",{class:"planner__day-column",key:u.date},[(n(!0),a(f,null,k(u.events,(T,E)=>(n(),w(ne,{key:E,event:T},null,8,["event"]))),128))]))),128)),(n(),a(f,null,k(p,(u,T)=>e("div",{class:"planner__line",key:T,style:x({top:`${u.percent}%`})},[e("div",we,v(u.time),1)],4)),64)),e("div",{class:"planner__line planner__line--now",style:x({top:`${l.value.styleTop}`}),ref_key:"timeLineEl",ref:r},[e("div",xe,v(l.value.caption),1)],4)])]))]),D(B)?(n(),w(he,{key:0,isOpened:t.value},null,8,["isOpened"])):m("",!0)]))}};export{De as default};
