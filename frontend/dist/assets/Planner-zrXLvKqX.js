import{e as _,g as T,f as M,h as k,r as P,o as r,i as D,w as z,c,b as e,t as y,j as g,n as x,k as C,l as S,m as H,F as b,p as w,u as B,q as W,s as N,v as R,x as U,_ as F,y as E,z as O,a as L,A as I,B as q,C as $,D as X}from"./index-9FteMrqT.js";const j={key:0,class:"event-card__short-wrapper"},A={class:"event-card__name"},G={class:"event-card__time"},Y={class:"event-card__name-wrapper"},J={key:1,class:"event-card__time"},K={__name:"EventCard",props:["event","gridHeight"],setup(l){const a=l,t=_(T(a.event.end.dateTime)-T(a.event.start.dateTime)),s=_(M(a.event.start.dateTime)),u=k(()=>T(a.event.start.dateTime)*100/24),d=k(()=>Math.max(t.value,.25)*100/24),v=k(()=>`${s.value} - ${M(a.event.end.dateTime)}`),p=k(()=>new Date(a.event.end.dateTime)<new Date),h=k(()=>a.gridHeight?[10,a.gridHeight/96]:[0,0]);return(n,o)=>{const i=P("vue-draggable-resizable");return l.gridHeight?(r(),D(i,{key:0,class:x(["event-card",{"no-padding":t.value<=.25,"no-right-padding":t.value<=.5,past:p.value}]),axis:"y",grid:h.value,handles:["tm","bm"],active:!0,style:C({top:`${u.value}%`,height:`calc(${d.value}% - 2px)`,backgroundColor:`${l.event.background_color}`,color:`${l.event.foreground_color}`})},{default:z(()=>[t.value<=.5?(r(),c("div",j,[e("span",A,y(l.event.summary)+", ",1),e("span",G,y(s.value),1)])):g("",!0),e("div",Y,[t.value>.5?(r(),c("span",{key:0,class:x(["event-card__name",{"one-string":t.value<=1}])},y(l.event.summary),3)):g("",!0)]),t.value>.5?(r(),c("span",J,y(v.value),1)):g("",!0)]),_:1},8,["grid","style","class"])):g("",!0)}}},Q=[{time:"01:00",percent:100/24},{time:"02:00",percent:200/24},{time:"03:00",percent:300/24},{time:"04:00",percent:400/24},{time:"05:00",percent:500/24},{time:"06:00",percent:600/24},{time:"07:00",percent:700/24},{time:"08:00",percent:800/24},{time:"09:00",percent:900/24},{time:"10:00",percent:1e3/24},{time:"11:00",percent:1100/24},{time:"12:00",percent:1200/24},{time:"13:00",percent:1300/24},{time:"14:00",percent:1400/24},{time:"15:00",percent:1500/24},{time:"16:00",percent:1600/24},{time:"17:00",percent:1700/24},{time:"18:00",percent:1800/24},{time:"19:00",percent:1900/24},{time:"20:00",percent:2e3/24},{time:"21:00",percent:2100/24},{time:"22:00",percent:2200/24},{time:"23:00",percent:2300/24}],Z={class:"planner__line-time"},ee={class:"planner__line-time"},te={__name:"PlannerGrid",props:["days"],setup(l){const a=_(null),t=_(),s=_(null),u=_(null),d=_({caption:"",styleTop:""}),v=()=>{u.value.style.display="none";const n=document.querySelector(".planner-date.current");if(!n)return;const o=(n.getBoundingClientRect().left-s.value.getBoundingClientRect().left)/s.value.offsetWidth*100,i=n.offsetWidth*.9/s.value.offsetWidth*100;u.value.style.left=`${o}%`,u.value.style.width=`${i}%`,u.value.style.display="block"},p=()=>{const n=new Date;d.value.caption=M(n),d.value.styleTop=`${T(n)*100/24}%`},h=async()=>{p(),await H(),v(),s.value.scrollIntoView({block:"center"});const o=(60-new Date().getSeconds())*1e3;setTimeout(()=>{p(),setInterval(p,6e4)},o)};return S(async()=>{await H(),h(),t.value=a.value.offsetHeight}),(n,o)=>(r(),c("div",{class:"planner__grid",ref_key:"grid",ref:a},[(r(!0),c(b,null,w(l.days,i=>(r(),c("div",{class:"planner__day-column",key:i.date},[(r(!0),c(b,null,w(i.events,(m,f)=>(r(),D(K,{key:f,event:m,gridHeight:t.value},null,8,["event","gridHeight"]))),128))]))),128)),(r(!0),c(b,null,w(B(Q),(i,m)=>(r(),c("div",{class:"planner__line",key:m,style:C({top:`${i.percent}%`})},[e("div",Z,y(i.time),1)],4))),128)),e("div",{class:"planner__line planner__line--now",style:C({top:`${d.value.styleTop}`}),ref_key:"timeLineEl",ref:s},[e("div",ee,y(d.value.caption),1),e("div",{class:"planner__line-today-line",ref_key:"todayLine",ref:u},null,512)],4)],512))}},ne={class:"planner-header"},ae={class:"planner-header__date"},se={class:"planner-header__buttons"},re={__name:"PlannerHeader",props:W(["isSidebarOpened","currentMonth"],{modelValue:{},modelModifiers:{}}),emits:W(["prevWeek","nextWeek"],["update:modelValue"]),setup(l,{emit:a}){const t=a,s=N(l,"modelValue");return(u,d)=>(r(),c("header",ne,[e("span",ae,y(l.currentMonth),1),e("div",se,[e("button",{class:"planner-header__date-button planner-header__date-button--prev icon-button",onClick:d[0]||(d[0]=v=>t("prevWeek"))}),e("button",{class:"planner-header__date-button planner-header__date-button--next icon-button",onClick:d[1]||(d[1]=v=>t("nextWeek"))})]),e("label",{class:x(["sidebar-hide icon-button",{rotated:!s.value}])},[R(e("input",{type:"checkbox",class:"visually-hidden","onUpdate:modelValue":d[2]||(d[2]=v=>s.value=v)},null,512),[[U,s.value]])],2)]))}},le={},oe={class:"loading-container"},ie=e("div",{class:"loading-progress"},null,-1),ce=[ie];function de(l,a){return r(),c("div",oe,ce)}const ue=F(le,[["render",de]]),_e={class:"planner-date__weekday"},ve={class:"planner-date__day"},pe={__name:"PlannerDate",props:["day"],setup(l){return(a,t)=>(r(),c("div",{class:x(["planner-date",{current:l.day.isToday}])},[e("span",_e,y(l.day.weekday),1),e("div",ve,[e("span",null,y(l.day.date),1)])],2))}},me={class:"task"},ye=["for"],he=["id"],fe={__name:"TaskItem",props:["task"],setup(l){return(a,t)=>(r(),c("div",me,[e("span",{class:"task__color",style:C({backgroundColor:l.task.color})},null,4),e("label",{class:"task__checkbox-label",for:a.title},[e("input",{class:"visually-hidden",id:a.title,type:"checkbox"},null,8,he)],8,ye),e("span",null,y(l.task.name),1)]))}},ge={class:"right-sidebar__tabs"},ke=e("span",null,"Tasks",-1),$e=[ke],be={class:"underline"},we={key:0,class:"tasks"},De={__name:"RightSidebar",props:["isOpened"],setup(l){const a=_(),t=_();_(null);const s=_(null),u=_(null),d=_(E.value.tasks);return S(()=>{u.value=s.value}),O(u,()=>{a.value.style.transform=`translateX(${u.value.offsetLeft}px)`,t.value.style.transform=`translateX(${u.value.offsetLeft}px)`}),(v,p)=>(r(),c("div",{class:x(["right-sidebar",{hidden:!l.isOpened}])},[e("div",ge,[e("button",{ref_key:"tasksButton",ref:s,class:"right-sidebar__tab",onClick:p[0]||(p[0]=h=>u.value=s.value)},$e,512),e("div",be,[e("div",{ref_key:"underlineRight",ref:a,class:"underline__closer underline__closer--right"},null,512),e("div",{ref_key:"underlineLeft",ref:t,class:"underline__closer underline__closer--left"},null,512)])]),u.value===s.value?(r(),c("div",we,[(r(!0),c(b,null,w(d.value,h=>(r(),D(fe,{key:h.id,task:h},null,8,["task"]))),128))])):g("",!0)],2))}},xe={class:"planner-wrapper"},Te={class:"planner"},Ce={key:0,class:"planner__loader-wrapper"},Le={key:1,class:"planner__grid-wrapper"},Me={class:"planner__days-header"},Se={__name:"Planner",setup(l){const a=_(!0),t=_([]),s=_(!0),u=(n,o)=>{const i=q(n);t.value=[];for(let m=0;m<7;m++){const f=new Date(i);f.setDate(i.getDate()+m),t.value.push({weekday:f.toLocaleDateString("en-EN",{weekday:"short"}),date:f.getDate(),isToday:$(f,new Date),day:f,events:o.filter(V=>$(f,new Date(V.start.dateTime))||$(f,new Date(V.end.dateTime)))})}},d=async(n=new Date)=>{try{const o=await I(n);u(n,o)}catch(o){console.error("ошибка",o)}finally{s.value=!1,await H()}},v=async()=>{if(s.value)return;s.value=!0;const n=t.value[0].day,o=new Date(n.setDate(n.getDate()+7));d(o)},p=async()=>{if(s.value)return;s.value=!0;const n=t.value[0].day,o=new Date(n.setDate(n.getDate()-7));d(o)},h=k(()=>{if(t.value.length){const n=t.value[0].day;return`${n.toLocaleString("default",{month:"long"})} ${n.getFullYear()}`}else return""});return S(()=>{d()}),O(X,n=>{n.forEach(o=>{const i=t.value.find(m=>$(m.day,new Date(o.start.dateTime))||$(m.day,new Date(o.end.dateTime)));i&&i.events.push(o)})}),(n,o)=>(r(),c("div",xe,[e("div",Te,[L(re,{modelValue:a.value,"onUpdate:modelValue":o[0]||(o[0]=i=>a.value=i),currentMonth:h.value,onPrevWeek:p,onNextWeek:v},null,8,["modelValue","currentMonth"]),s.value?(r(),c("div",Ce,[L(ue)])):g("",!0),s.value?g("",!0):(r(),c("div",Le,[e("div",Me,[(r(!0),c(b,null,w(t.value,i=>(r(),D(pe,{key:i.date,day:i},null,8,["day"]))),128))]),L(te,{days:t.value},null,8,["days"])]))]),B(E)?(r(),D(De,{key:0,isOpened:a.value},null,8,["isOpened"])):g("",!0)]))}};export{Se as default};
